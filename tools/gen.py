#!/usr/bin/env python
#
# Generate Actions from AWS static configuration
#
import json
import os
try:
    from urllib2 import urlopen
except ImportError:
    from urllib.request import urlopen
from slimit.parser import Parser
from slimit.visitors import nodevisitor
from slimit.visitors.ecmavisitor import ECMAVisitor
from slimit import ast


header = """\
# Copyright (c) 2012-2013, Mark Peek <mark@peek.org>
# All rights reserved.
#
# See LICENSE file for full license.

from aws import Action as BaseAction
from aws import BaseARN
"""

extra_classes = """\
class Action(BaseAction):
    def __init__(self, action=None):
        sup = super(Action, self)
        sup.__init__(prefix, action)


class ARN(BaseARN):
    def __init__(self, resource='', region='', account=''):
        sup = super(ARN, self)
        sup.__init__(service=prefix, resource=resource, region=region,
                     account=account)
"""

extra_classes_s3 = """\
class Action(BaseAction):
    def __init__(self, action=None):
        sup = super(Action, self)
        sup.__init__(prefix, action)


class ARN(BaseARN):
    def __init__(self, resource='', region='', account=''):
        sup = super(ARN, self)
        # account is empty for S3
        account = ''
        sup.__init__(service=prefix, resource=resource, region=region,
                     account=account)
"""

arn = """\
class %(upper)s_ARN(ARN):
    def __init__(self, *args, **kwargs):
        super(%(upper)s_ARN, self).__init__(*args, **kwargs)
        warnings.warn("This class is going away. Use %(lower)s.ARN instead.",
                      FutureWarning)
"""

legacy_arns = ['iam', 's3', 'sdb', 'sns', 'sqs']

aws_url = \
    "https://awsiamconsole.s3.amazonaws.com/iam/assets/js/bundles/policies.js"

basedir = 'generated'

response = urlopen(aws_url)
config = response.read()


class JSONVisitor(ECMAVisitor):
    def visit_Identifier(self, node):
        return '"%s"' % node.value

    def visit_Number(self, node):
        return '"%s"' % node.value

    def visit_UnaryOp(self, node):
        s = self.visit(node.value)
        if node.op == '!' and s == 0:
            return '"true"'
        else:
            return s


visitor = JSONVisitor()
parser = Parser()
tree = parser.parse(config.decode('utf-8'))

flag = False
policy_editor_config = ""
for node in nodevisitor.visit(tree):
    if (isinstance(node, ast.Identifier) and
            node.value == 'PolicyEditorConfig'):
        flag = True
    elif flag:
        policy_editor_config = visitor.visit(node)
        break

d = json.loads(policy_editor_config)

try:
    os.mkdir(basedir)
except OSError:
    pass


# Extra services are for those not advertised in policies.js,
# but are available to be called via AWS apis. If/When these
# services are added to policies.js, the entry in extra_services
# will be ignored. IE, policies.js takes priority over
# extra_services entries.

extra_services = {
    'AWS Accounts': {
        'StringPrefix': 'account',
        'Actions': [
            'DisableRegion',
            'EnableRegion',
            'ListRegions',
        ],
    },
    'AWS Certificate Manager Private Certificate Authority': {
        'StringPrefix': 'acm-pca',
        'Actions': [
            'CreateCertificateAuthority',
            'CreateCertificateAuthorityAuditReport',
            'CreatePermission',
            'DeleteCertificateAuthority',
            'DeletePermission',
            'DescribeCertificateAuthority',
            'DescribeCertificateAuthorityAuditReport',
            'GetCertificate',
            'GetCertificateAuthorityCertificate',
            'GetCertificateAuthorityCsr',
            'ImportCertificateAuthorityCertificate',
            'IssueCertificate',
            'ListCertificateAuthorities',
            'ListPermissions',
            'ListTags',
            'RestoreCertificateAuthority',
            'RevokeCertificate',
            'TagCertificateAuthority',
            'UntagCertificateAuthority',
            'UpdateCertificateAuthority',
        ],
    },
    'AWS Amplify': {
        'StringPrefix': 'amplify',
        'Actions': [
            'CreateApp',
            'CreateBackendEnvironment',
            'CreateBranch',
            'CreateDeployment',
            'CreateDomainAssociation',
            'CreateWebHook',
            'DeleteApp',
            'DeleteBackendEnvironment',
            'DeleteBranch',
            'DeleteDomainAssociation',
            'DeleteJob',
            'DeleteWebHook',
            'GenerateAccessLogs',
            'GetApp',
            'GetArtifactUrl',
            'GetBackendEnvironment',
            'GetBranch',
            'GetDomainAssociation',
            'GetJob',
            'GetWebHook',
            'ListApps',
            'ListArtifacts',
            'ListBackendEnvironments',
            'ListBranches',
            'ListDomainAssociations',
            'ListJobs',
            'ListWebHooks',
            'StartDeployment',
            'StartJob',
            'StopJob',
            'TagResource',
            'UntagResource',
            'UpdateApp',
            'UpdateBranch',
            'UpdateDomainAssociation',
            'UpdateWebHook',
        ],
    },
    'AWS App Mesh': {
        'StringPrefix': 'appmesh',
        'Actions': [
            'CreateMesh',
            'CreateRoute',
            'CreateVirtualNode',
            'CreateVirtualRouter',
            'CreateVirtualService',
            'DeleteMesh',
            'DeleteRoute',
            'DeleteVirtualNode',
            'DeleteVirtualRouter',
            'DeleteVirtualService',
            'DescribeMesh',
            'DescribeRoute',
            'DescribeVirtualNode',
            'DescribeVirtualRouter',
            'DescribeVirtualService',
            'ListMeshes',
            'ListRoutes',
            'ListTagsForResource',
            'ListVirtualNodes',
            'ListVirtualRouters',
            'ListVirtualServices',
            'StreamAggregatedResources',
            'TagResource',
            'UntagResource',
            'UpdateMesh',
            'UpdateRoute',
            'UpdateVirtualNode',
            'UpdateVirtualRouter',
            'UpdateVirtualService',
        ],
    },
    'AWS Backup': {
        'StringPrefix': 'backup',
        'Actions': [
            'CopyIntoBackupVault',
            'CreateBackupPlan',
            'CreateBackupSelection',
            'CreateBackupVault',
            'DeleteBackupPlan',
            'DeleteBackupSelection',
            'DeleteBackupVault',
            'DeleteBackupVaultAccessPolicy',
            'DeleteBackupVaultNotifications',
            'DeleteRecoveryPoint',
            'DescribeBackupJob',
            'DescribeBackupVault',
            'DescribeCopyJob',
            'DescribeProtectedResource',
            'DescribeRecoveryPoint',
            'DescribeRestoreJob',
            'ExportBackupPlanTemplate',
            'GetBackupPlan',
            'GetBackupPlanFromJSON',
            'GetBackupPlanFromTemplate',
            'GetBackupSelection',
            'GetBackupVaultAccessPolicy',
            'GetBackupVaultNotifications',
            'GetRecoveryPointRestoreMetadata',
            'GetSupportedResourceTypes',
            'ListBackupJobs',
            'ListBackupPlanTemplates',
            'ListBackupPlanVersions',
            'ListBackupPlans',
            'ListBackupSelections',
            'ListBackupVaults',
            'ListCopyJobs',
            'ListProtectedResources',
            'ListRecoveryPointsByBackupVault',
            'ListRecoveryPointsByResource',
            'ListRestoreJobs',
            'ListTags',
            'PutBackupVaultAccessPolicy',
            'PutBackupVaultNotifications',
            'StartBackupJob',
            'StartCopyJob',
            'StartRestoreJob',
            'StopBackupJob',
            'TagResource',
            'UntagResource',
            'UpdateBackupPlan',
            'UpdateRecoveryPointLifecycle',
        ],
    },
    'AWS CodeArtifact': {
        'StringPrefix': 'codeartifact',
        'Actions': [
            'AssociateExternalConnection',
            'AssociateWithDownstreamRepository',
            'CopyPackageVersions',
            'CreateDomain',
            'CreateRepository',
            'DeleteDomain',
            'DeleteDomainPermissionsPolicy',
            'DeletePackageVersions',
            'DeleteRepository',
            'DeleteRepositoryPermissionsPolicy',
            'DescribeDomain',
            'DescribePackageVersion',
            'DescribeRepository',
            'DisassociateExternalConnection',
            'DisposePackageVersions',
            'GetAuthorizationToken',
            'GetDomainPermissionsPolicy',
            'GetPackageVersionAsset',
            'GetPackageVersionReadme',
            'GetRepositoryEndpoint',
            'GetRepositoryPermissionsPolicy',
            'ListDomains',
            'ListPackageVersionAssets',
            'ListPackageVersionDependencies',
            'ListPackageVersions',
            'ListPackages',
            'ListRepositories',
            'ListRepositoriesInDomain',
            'PublishPackageVersion',
            'PutDomainPermissionsPolicy',
            'PutPackageMetadata',
            'PutRepositoryPermissionsPolicy',
            'ReadFromRepository',
            'UpdatePackageVersionsStatus',
            'UpdateRepository'
        ],
    },
    'Comprehend Medical': {
        'StringPrefix': 'comprehendmedical',
        'Actions': [
            'DetectEntities',
            'DetectPHI',
        ],
    },
    'DataSync': {
        'StringPrefix': 'datasync',
        'Actions': [
            'CancelTaskExecution',
            'CreateAgent',
            'CreateLocationEfs',
            'CreateLocationNfs',
            'CreateLocationS3',
            'CreateLocationSmb',
            'CreateTask',
            'DeleteAgent',
            'DeleteLocation',
            'DeleteTask',
            'DescribeAgent',
            'DescribeLocationEfs',
            'DescribeLocationNfs',
            'DescribeLocationS3',
            'DescribeLocationSmb',
            'DescribeTask',
            'DescribeTaskExecution',
            'ListAgents',
            'ListLocations',
            'ListTagsForResource',
            'ListTaskExecutions',
            'ListTasks',
            'StartTaskExecution',
            'TagResource',
            'UntagResource',
            'UpdateAgent',
            'UpdateTask',
        ],
    },
    'AWS DeepLens': {
        'StringPrefix': 'deeplens',
        'Actions': [
            'AssociateServiceRoleToAccount',
            'BatchGetDevice',
            'BatchGetModel',
            'BatchGetProject',
            'CreateDeviceCertificates',
            'CreateModel',
            'CreateProject',
            'DeleteModel',
            'DeleteProject',
            'DeployProject',
            'DeregisterDevice',
            'GetAssociatedResources',
            'GetDeploymentStatus',
            'GetDevice',
            'GetModel',
            'GetProject',
            'ImportProjectFromTemplate',
            'ListDeployments',
            'ListDevices',
            'ListModels',
            'ListProjects',
            'RegisterDevice',
            'RemoveProject',
            'UpdateProject',
        ],
    },
    'Amazon Data Lifecycle Manager': {
        'StringPrefix': 'dlm',
        'Actions': [
            'CreateLifecyclePolicy',
            'DeleteLifecyclePolicy',
            'GetLifecyclePolicies',
            'GetLifecyclePolicy',
            'UpdateLifecyclePolicy',
        ],
    },
    'Amazon Elastic Container Service for Kubernetes': {
        'StringPrefix': 'eks',
        'Actions': [
            'CreateCluster',
            'DeleteCluster',
            'DescribeCluster',
            'DescribeUpdate',
            'ListClusters',
            'ListTagsForResource',
            'ListUpdates',
            'TagResource',
            'UntagResource',
            'UpdateClusterConfig',
            'UpdateClusterVersion',
        ],
    },
    'Amazon Elastic Inference': {
        'StringPrefix': 'elastic-inference',
        'Actions': [
            'Connect',
        ],
    },
    'AWS Firewall Manager': {
        'StringPrefix': 'fms',
        'Actions': [
            'AssociateAdminAccount',
            'DeleteNotificationChannel',
            'DeletePolicy',
            'DisassociateAdminAccount',
            'GetAdminAccount',
            'GetComplianceDetail',
            'GetNotificationChannel',
            'GetPolicy',
            'GetProtectionStatus',
            'ListComplianceStatus',
            'ListMemberAccounts',
            'ListPolicies',
            'PutNotificationChannel',
            'PutPolicy',
        ],
    },
    'Amazon FSx': {
        'StringPrefix': 'fsx',
        'Actions': [
            'CreateBackup',
            'CreateFileSystem',
            'CreateFileSystemFromBackup',
            'DeleteBackup',
            'DeleteFileSystem',
            'DescribeBackups',
            'DescribeFileSystems',
            'ListTagsForResource',
            'TagResource',
            'UntagResource',
            'UpdateFileSystem',
        ],
    },
    'Global Accelerator': {
        'StringPrefix': 'globalaccelerator',
        'Actions': [
            'CreateAccelerator',
            'CreateEndpointGroup',
            'CreateListener',
            'DeleteAccelerator',
            'DeleteEndpointGroup',
            'DeleteListener',
            'DescribeAccelerator',
            'DescribeAcceleratorAttributes',
            'DescribeEndpointGroup',
            'DescribeListener',
            'ListAccelerators',
            'ListEndpointGroups',
            'ListListeners',
            'UpdateAccelerator',
            'UpdateAcceleratorAttributes',
            'UpdateEndpointGroup',
            'UpdateListener',
        ],
    },
    'Amazon GroundTruth Labeling': {
        'StringPrefix': 'groundtruthlabeling',
        'Actions': [
            'DescribeConsoleJob',
            'ListDatasetObjects',
            'RunFilterOrSampleDatasetJob',
            'RunGenerateManifestByCrawlingJob',
        ],
    },
    'AWS IoT 1-Click': {
        'StringPrefix': 'iot1click',
        'Actions': [
            'AssociateDeviceWithPlacement',
            'ClaimDevicesByClaimCode',
            'CreatePlacement',
            'CreateProject',
            'DeletePlacement',
            'DeleteProject',
            'DescribeDevice',
            'DescribePlacement',
            'DescribeProject',
            'DisassociateDeviceFromPlacement',
            'FinalizeDeviceClaim',
            'GetDeviceMethods',
            'GetDevicesInPlacement',
            'InitializeDeviceClaim',
            'InitiateDeviceClaim',
            'InvokeDeviceMethod',
            'ListDeviceEvents',
            'ListDevices',
            'ListPlacements',
            'ListProjects',
            'ListTagsForResource',
            'TagResource',
            'UnclaimDevice',
            'UntagResource',
            'UpdateDeviceState',
            'UpdatePlacement',
            'UpdateProject',
        ],
    },
    'AWS IoT Events': {
        'StringPrefix': 'iotevents',
        'Actions': [
            'BatchPutMessage',
            'BatchUpdateDetector',
            'CreateDetectorModel',
            'CreateInput',
            'DeleteDetectorModel',
            'DeleteInput',
            'DescribeDetector',
            'DescribeDetectorModel',
            'DescribeInput',
            'DescribeLoggingOptions',
            'ListDetectorModelVersions',
            'ListDetectorModels',
            'ListDetectors',
            'ListInputs',
            'ListTagsForResource',
            'PutLoggingOptions',
            'TagResource',
            'UntagResource',
            'UpdateDetectorModel',
            'UpdateInput',
            'UpdateInputRouting',
        ],
    },
    'AWS IoT SiteWise': {
        'StringPrefix': 'iotsitewise',
        'Actions': [
            'AssociateGatewaySink',
            'AssociateGatewaySource',
            'AssociateViewEntities',
            'CreateAsset',
            'CreateAssetTemplate',
            'CreateGateway',
            'CreateGroup',
            'CreateMeasurementDataStore',
            'CreateMetricType',
            'CreateView',
            'DeleteAsset',
            'DeleteAssetTemplate',
            'DeleteGateway',
            'DeleteGroup',
            'DeleteMeasurementDataStore',
            'DeleteMetricType',
            'DeleteView',
            'DeregisterViewEntities',
            'DescribeAssetTemplates',
            'DescribeAssets',
            'DescribeGateways',
            'DescribeGroups',
            'DescribeMeasurementDataStores',
            'DescribeMetricTypes',
            'DescribeViews',
            'DisassociateGatewaySink',
            'DisassociateGatewaySource',
            'DisassociateViewEntities',
            'GetMeasurementData',
            'GetMetricData',
            'ListAssetTemplates',
            'ListAssets',
            'ListGateways',
            'ListGroups',
            'ListMeasurementDataStores',
            'ListMeasurementDataStreams',
            'ListMetricTypes',
            'ListViewEntities',
            'ListViews',
            'RegisterViewEntities',
            'UpdateAsset',
            'UpdateAssetTemplate',
            'UpdateGateway',
            'UpdateGroup',
            'UpdateMeasurementDataStore',
            'UpdateView',
        ],
    },
    'Amazon Managed Streaming for Kafka': {
        'StringPrefix': 'kafka',
        'Actions': [
            'CreateCluster',
            'CreateConfiguration',
            'DeleteCluster',
            'DescribeCluster',
            'DescribeClusterOperation',
            'DescribeConfiguration',
            'DescribeConfigurationRevision',
            'GetBootstrapBrokers',
            'ListClusterOperations',
            'ListClusters',
            'ListConfigurations',
            'ListNodes',
            'ListTagsForResource',
            'TagResource',
            'UntagResource',
            'UpdateBrokerStorage',
            'UpdateClusterConfiguration',
        ],
    },
    'Amazon Kinesis Analytics V2': {
        'StringPrefix': 'kinesisanalytics',
        'Actions': [
            # V1 and V2 share the same prefix.  To avoid duplicates in
            # kinesisanalytics.py, actions that are available in both
            # versions are commented out in this list.
            'AddApplicationCloudWatchLoggingOption',
            # 'AddApplicationInput',
            'AddApplicationInputProcessingConfiguration',
            # 'AddApplicationOutput',
            # 'AddApplicationReferenceDataSource',
            # 'CreateApplication',
            'CreateApplicationSnapshot',
            # 'DeleteApplication',
            'DeleteApplicationCloudWatchLoggingOption',
            'DeleteApplicationInputProcessingConfiguration',
            # 'DeleteApplicationOutput',
            # 'DeleteApplicationReferenceDataSource',
            'DeleteApplicationSnapshot',
            # 'DescribeApplication',
            'DescribeApplicationSnapshot',
            # 'DiscoverInputSchema',
            'ListApplicationSnapshots',
            # 'ListApplications',
            # 'StartApplication',
            # 'StopApplication',
            # 'UpdateApplication',
        ],
    },
    'AWS License Manager': {
        'StringPrefix': 'license-manager',
        'Actions': [
            'CreateLicenseConfiguration',
            'DeleteLicenseConfiguration',
            'GetLicenseConfiguration',
            'GetServiceSettings',
            'ListAssociationsForLicenseConfiguration',
            'ListLicenseConfigurations',
            'ListLicenseSpecificationsForResource',
            'ListResourceInventory',
            'ListTagsForResource',
            'ListUsageForLicenseConfiguration',
            'TagResource',
            'UntagResource',
            'UpdateLicenseConfiguration',
            'UpdateLicenseSpecificationsForResource',
            'UpdateServiceSettings',
        ],
    },
    'Amazon Macie': {
        'StringPrefix': 'macie',
        'Actions': [
            'AssociateMemberAccount',
            'AssociateS3Resources',
            'DisassociateMemberAccount',
            'DisassociateS3Resources',
            'ListMemberAccounts',
            'ListS3Resources',
            'UpdateS3Resources',
        ],
    },
    'Amazon Managed Blockchain': {
        'StringPrefix': 'managedblockchain',
        'Actions': [
            'CreateMember',
            'CreateNetwork',
            'CreateNode',
            'CreateProposal',
            'DeleteMember',
            'DeleteNode',
            'GetMember',
            'GetNetwork',
            'GetNode',
            'GetProposal',
            'ListInvitations',
            'ListMembers',
            'ListNetworks',
            'ListNodes',
            'ListProposalVotes',
            'ListProposals',
            'RejectInvitation',
            'VoteOnProposal',
        ],
    },
    'AWS Elemental MediaConnect': {
        'StringPrefix': 'mediaconnect',
        'Actions': [
            'AddFlowOutputs',
            'CreateFlow',
            'DeleteFlow',
            'DescribeFlow',
            'GrantFlowEntitlements',
            'ListEntitlements',
            'ListFlows',
            'RemoveFlowOutput',
            'RevokeFlowEntitlement',
            'StartFlow',
            'StopFlow',
            'UpdateFlowEntitlement',
            'UpdateFlowOutput',
            'UpdateFlowSource',
        ],
    },
    'AWS Elemental MediaTailor': {
        'StringPrefix': 'mediatailor',
        'Actions': [
            'DeletePlaybackConfiguration',
            'GetPlaybackConfiguration',
            'ListPlaybackConfigurations',
            'ListTagsForResource',
            'PutPlaybackConfiguration',
            'TagResource',
            'UntagResource',
        ],
    },
    'Amazon Neptune': {
        'StringPrefix': 'neptune-db',
        'Actions': [
            'connect',
        ],
    },
    'AWS Performance Insights': {
        'StringPrefix': 'pi',
        'Actions': [
            'DescribeDimensionKeys',
            'GetResourceMetrics',
        ],
    },
    'QuickSight': {
        'StringPrefix': 'quicksight',
        'Actions': [
            'CreateAdmin',
            'CreateDashboard',
            'CreateGroup',
            'CreateGroupMembership',
            'CreateIAMPolicyAssignment',
            'CreateReader',
            'CreateTemplate',
            'CreateTemplateAlias',
            'CreateUser',
            'DeleteDashboard',
            'DeleteGroup',
            'DeleteGroupMembership',
            'DeleteIAMPolicyAssignment',
            'DeleteTemplate',
            'DeleteTemplateAlias',
            'DeleteUser',
            'DeleteUserByPrincipalId',
            'DescribeDashboard',
            'DescribeDashboardPermissions',
            'DescribeGroup',
            'DescribeIAMPolicyAssignment',
            'DescribeTemplate',
            'DescribeTemplateAlias',
            'DescribeTemplatePermissions',
            'DescribeUser',
            'GetAuthCode',
            'GetDashboardEmbedUrl',
            'GetGroupMapping',
            'ListDashboardVersions',
            'ListDashboards',
            'ListGroupMemberships',
            'ListGroups',
            'ListIAMPolicyAssignments',
            'ListIAMPolicyAssignmentsForUser',
            'ListTagsForResource',
            'ListTemplateAliases',
            'ListTemplateVersions',
            'ListTemplates',
            'ListUserGroups',
            'ListUsers',
            'RegisterUser',
            'SearchDirectoryGroups',
            'SetGroupMapping',
            'Subscribe',
            'TagResource',
            'Unsubscribe',
            'UntagResource',
            'UpdateDashboard',
            'UpdateDashboardPermissions',
            'UpdateDashboardPublishedVersion',
            'UpdateGroup',
            'UpdateIAMPolicyAssignment',
            'UpdateTemplate',
            'UpdateTemplateAlias',
            'UpdateTemplatePermissions',
            'UpdateUser',
        ]
    },
    'AWS Resource Access Manager': {
        'StringPrefix': 'ram',
        'Actions': [
            'AcceptResourceShareInvitation',
            'AssociateResourceShare',
            'AssociateResourceSharePermission',
            'CreateResourceShare',
            'DeleteResourceShare',
            'DisassociateResourceShare',
            'DisassociateResourceSharePermission',
            'EnableSharingWithAwsOrganization',
            'GetPermission',
            'GetResourcePolicies',
            'GetResourceShareAssociations',
            'GetResourceShareInvitations',
            'GetResourceShares',
            'ListPendingInvitationResources',
            'ListPermissions',
            'ListPrincipals',
            'ListResources',
            'ListResourceSharePermissions',
            'RejectResourceShareInvitation',
            'TagResource',
            'UntagResource',
            'UpdateResourceShare',
        ],
    },
    'AWS RoboMaker': {
        'StringPrefix': 'robomaker',
        'Actions': [
            'BatchDescribeSimulationJob',
            'CancelDeploymentJob',
            'CancelSimulationJob',
            'CancelSimulationJobBatch',
            'CreateDeploymentJob',
            'CreateFleet',
            'CreateRobot',
            'CreateRobotApplication',
            'CreateRobotApplicationVersion',
            'CreateSimulationApplication',
            'CreateSimulationApplicationVersion',
            'CreateSimulationJob',
            'DeleteFleet',
            'DeleteRobot',
            'DeleteRobotApplication',
            'DeleteSimulationApplication',
            'DeregisterRobot',
            'DescribeDeploymentJob',
            'DescribeFleet',
            'DescribeRobot',
            'DescribeRobotApplication',
            'DescribeSimulationApplication',
            'DescribeSimulationJob',
            'DescribeSimulationJobBatch',
            'ListDeploymentJobs',
            'ListFleets',
            'ListRobotApplications',
            'ListRobots',
            'ListSimulationApplications',
            'ListSimulationJobBatches',
            'ListSimulationJobs',
            'ListTagsForResource',
            'RegisterRobot',
            'RestartSimulationJob',
            'StartSimulationJobBatch',
            'SyncDeploymentJob',
            'TagResource',
            'UntagResource',
            'UpdateRobotApplication',
            'UpdateSimulationApplication',
        ],
    },
    'Amazon Route 53 Resolver': {
        'StringPrefix': 'route53resolver',
        'Actions': [
            'AssociateResolverEndpointIpAddress',
            'AssociateResolverRule',
            'CreateResolverEndpoint',
            'CreateResolverRule',
            'DeleteResolverEndpoint',
            'DeleteResolverRule',
            'DisassociateResolverEndpointIpAddress',
            'DisassociateResolverRule',
            'GetResolverEndpoint',
            'GetResolverRule',
            'GetResolverRuleAssociation',
            'GetResolverRulePolicy',
            'ListResolverEndpointIpAddresses',
            'ListResolverEndpoints',
            'ListResolverRuleAssociations',
            'ListResolverRules',
            'ListTagsForResource',
            'PutResolverRulePolicy',
            'TagResource',
            'UntagResource',
            'UpdateResolverEndpoint',
            'UpdateResolverRule',
        ],
    },
    'AWS Secrets Manager': {
        'ARNFormat': 'arn:aws:secretsmanager:'
                     '<region>:<account>'
                     ':secret:<resourceType>/<resourcePath>',
        'ARNRegex': '^arn:aws:secretsmanager:.+',
        'Actions': [
            'CancelRotateSecret', 'CreateSecret', 'DeleteResourcePolicy',
            'DeleteSecret', 'DescribeSecret', 'GetRandomPassword',
            'GetResourcePolicy', 'GetSecretValue', 'ListSecrets',
            'ListSecretVersionIds', 'PutResourcePolicy',
            'PutSecretValue', 'RestoreSecret', 'RotateSecret',
            'TagResource', 'UntagResource', 'UpdateSecret',
            'UpdateSecretVersionStage'
        ],
        'HasResource': '!0',
        'StringPrefix': 'secretsmanager',
        'conditionKeys': [
            'secretsmanager:Resource/AllowRotationLambdaArn',
            'secretsmanager:Description',
            'secretsmanager:ForceDeleteWithoutRecovery',
            'secretsmanager:KmsKeyId',
            'secretsmanager:Name',
            'secretsmanager:RecoveryWindowInDays',
            'secretsmanager:ResourceTag/<tagname>',
            'secretsmanager:RotationLambdaArn',
            'secretsmanager:SecretId',
            'secretsmanager:VersionId',
            'secretsmanager:VersionStage'
        ],
    },
    'AWS Security Hub': {
        'StringPrefix': 'securityhub',
        'Actions': [
            'AcceptInvitation',
            'BatchDisableStandards',
            'BatchEnableStandards',
            'BatchImportFindings',
            'CreateActionTarget',
            'CreateInsight',
            'CreateMembers',
            'DeclineInvitations',
            'DeleteActionTarget',
            'DeleteInsight',
            'DeleteInvitations',
            'DeleteMembers',
            'DescribeActionTargets',
            'DescribeHub',
            'DescribeProducts',
            'DescribeStandards',
            'DescribeStandardsControls',
            'DisableImportFindingsForProduct',
            'DisableSecurityHub',
            'DisassociateFromMasterAccount',
            'DisassociateMembers',
            'EnableImportFindingsForProduct',
            'EnableSecurityHub',
            'GetEnabledStandards',
            'GetFindings',
            'GetInsightResults',
            'GetInsights',
            'GetInvitationsCount',
            'GetMasterAccount',
            'GetMembers',
            'InviteMembers',
            'ListEnabledProductsForImport',
            'ListInvitations',
            'ListMembers',
            'ListProductSubscribers',
            'ListTagsForResource',
            'TagResource',
            'UntagResource',
            'UpdateActionTarget',
            'UpdateFindings',
            'UpdateInsight',
            'UpdateStandardsControl',
        ],
    },
    'AWS Server Migration Service': {
        'StringPrefix': 'sms',
        'Actions': [
            'CreateApp',
            'CreateReplicationJob',
            'DeleteApp',
            'DeleteAppLaunchConfiguration',
            'DeleteAppReplicationConfiguration',
            'DeleteReplicationJob',
            'DeleteServerCatalog',
            'DisassociateConnector',
            'DisassociateConnectors',
            'GenerateChangeSet',
            'GenerateTemplate',
            'GetApp',
            'GetAppLaunchConfiguration',
            'GetAppReplicationConfiguration',
            'GetConnectors',
            'GetMessages',
            'GetReplicationJobs',
            'GetReplicationRuns',
            'GetServers',
            'ImportServerCatalog',
            'LaunchApp',
            'ListApps',
            'PutAppLaunchConfiguration',
            'PutAppReplicationConfiguration',
            'SendMessage',
            'StartAppReplication',
            'StartOnDemandReplicationRun',
            'StopAppReplication',
            'TerminateApp',
            'UpdateApp',
            'UpdateReplicationJob',
        ],
    },
    'Amazon Pinpoint SMS and Voice Service': {
        'StringPrefix': 'sms-voice',
        'Actions': [
            'CreateConfigurationSet',
            'CreateConfigurationSetEventDestination',
            'DeleteConfigurationSet',
            'DeleteConfigurationSetEventDestination',
            'GetConfigurationSetEventDestinations',
            'ListConfigurationSets',
            'SendVoiceMessage',
            'UpdateConfigurationSetEventDestination',
        ],
    },
    'SMM Messages': {
        'StringPrefix': 'ssmmessages',
        'Actions': [
            'CreateControlChannel',
            'CreateDataChannel',
            'OpenControlChannel',
            'OpenDataChannel',
        ],
    },
    'AWS SSO Directory': {
        'StringPrefix': 'sso-directory',
        'Actions': [
            'AddMemberToGroup',
            'CreateAlias',
            'CreateGroup',
            'CreateUser',
            'DeleteGroup',
            'DeleteUser',
            'DescribeDirectory',
            'DescribeGroups',
            'DescribeUsers',
            'DisableUser',
            'EnableUser',
            'ListGroupsForUser',
            'ListMembersInGroup',
            'RemoveMemberFromGroup',
            'UpdateGroup',
            'UpdatePassword',
            'UpdateUser',
            'VerifyEmail',
        ],
    },
    'Amazon Sumerian': {
        'StringPrefix': 'sumerian',
        'Actions': [
            'Login',
            'ViewRelease',
        ],
    },
    'Amazon Textract': {
        'StringPrefix': 'textract',
        'Actions': [
            'AnalyzeDocument',
            'DetectDocumentText',
            'GetDocumentAnalysis',
            'GetDocumentTextDetection',
            'StartDocumentAnalysis',
            'StartDocumentTextDetection',
        ],
    },
    'AWS Transfer for SFTP': {
        'StringPrefix': 'transfer',
        'Actions': [
            'CreateServer',
            'CreateUser',
            'DeleteServer',
            'DeleteSshPublicKey',
            'DeleteUser',
            'DescribeServer',
            'DescribeUser',
            'ImportSshPublicKey',
            'ListServers',
            'ListTagsForResource',
            'ListUsers',
            'StartServer',
            'StopServer',
            'TagResource',
            'TestIdentityProvider',
            'UntagResource',
            'UpdateServer',
            'UpdateUser',
        ],
    },
    'AWS Well-Architected Tool': {
        'StringPrefix': 'wellarchitected',
        'Actions': [
            'CreateWorkload',
            'CreateWorkloadShare',
            'DeleteWorkload',
            'GetWorkload',
            'ListWorkloads',
        ],
    },
    'Amazon WorkLink': {
        'StringPrefix': 'worklink',
        'Actions': [
            'AssociateDomain',
            'AssociateWebsiteAuthorizationProvider',
            'AssociateWebsiteCertificateAuthority',
            'CreateFleet',
            'DeleteFleet',
            'DescribeAuditStreamConfiguration',
            'DescribeCompanyNetworkConfiguration',
            'DescribeDevice',
            'DescribeDevicePolicyConfiguration',
            'DescribeDomain',
            'DescribeFleetMetadata',
            'DescribeIdentityProviderConfiguration',
            'DescribeWebsiteCertificateAuthority',
            'DisassociateDomain',
            'DisassociateWebsiteAuthorizationProvider',
            'DisassociateWebsiteCertificateAuthority',
            'ListDevices',
            'ListDomains',
            'ListFleets',
            'ListWebsiteAuthorizationProviders',
            'ListWebsiteCertificateAuthorities',
            'RestoreDomainAccess',
            'RevokeDomainAccess',
            'SignOutUser',
            'UpdateAuditStreamConfiguration',
            'UpdateCompanyNetworkConfiguration',
            'UpdateDevicePolicyConfiguration',
            'UpdateDomainMetadata',
            'UpdateFleetMetadata',
            'UpdateIdentityProviderConfiguration',
        ],
    },
}

# Extra actions are for services that are advertised in the policies.js, but
# have one or more individual actions that are missing. Actions specified here
# will be patched with the advertised ones, creating a union of both.
# Actions should be added alphabetically under their appropriate awacs prefix.
# Note: If the prefix contains a '-' (dash) character, replace it with
# an '_' (underscore).
extra_actions = {
    'a4b': [
        'ApproveSkill',
        'AssociateContactWithAddressBook',
        'AssociateSkillWithSkillGroup',
        'AssociateSkillWithUsers',
        'CompleteRegistration',
        'CreateAddressBook',
        'CreateBusinessReportSchedule',
        'CreateConferenceProvider',
        'CreateContact',
        'DeleteAddressBook',
        'DeleteBusinessReportSchedule',
        'DeleteConferenceProvider',
        'DeleteContact',
        'DeleteDevice',
        'DeleteSkillAuthorization',
        'DisassociateContactFromAddressBook',
        'DisassociateSkillFromSkillGroup',
        'DisassociateSkillFromUsers',
        'ForgetSmartHomeAppliances',
        'GetAddressBook',
        'GetConferencePreference',
        'GetConferenceProvider',
        'GetContact',
        'GetNetworkProfile',
        'ListBusinessReportSchedules',
        'ListConferenceProviders',
        'ListDeviceEvents',
        'ListSkillsStoreCategories',
        'ListSkillsStoreSkillsByCategory',
        'ListSmartHomeAppliances',
        'PutConferencePreference',
        'PutDeviceSetupEvents',
        'PutSkillAuthorization',
        'RegisterAVSDevice',
        'RegisterDevice',
        'RejectSkill',
        'SearchAddressBooks',
        'SearchContacts',
        'SearchNetworkProfiles',
        'StartSmartHomeApplianceDiscovery',
        'UpdateAddressBook',
        'UpdateBusinessReportSchedule',
        'UpdateConferenceProvider',
        'UpdateContact',
    ],
    'acm': [
        'ExportCertificate',
        'RenewCertificate',
        'UpdateCertificateOptions',
    ],
    'apigateway': [
        'UpdateRestApiPolicy',
        'SetWebACL',
    ],
    'appstream': [
        'BatchAssociateUserStack',
        'BatchDisassociateUserStack',
        'CopyImage',
        'CreateUsageReportSubscription',
        'CreateUser',
        'DeleteImagePermissions',
        'DeleteUsageReportSubscription',
        'DeleteUser',
        'DescribeImagePermissions',
        'DescribeUsageReportSubscriptions',
        'DescribeUserStackAssociations',
        'DescribeUsers',
        'DisableUser',
        'EnableUser',
        'GetImageBuilders',
        'GetParametersForThemeAssetUpload',
        'UpdateImagePermissions',
    ],
    'appsync': [
        'CreateFunction',
        'DeleteFunction',
        'GetFunction',
        'ListFunctions',
        'ListResolversByFunction',
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
        'UpdateFunction',
    ],
    'athena': [
        'CreateWorkGroup',
        'DeleteWorkGroup',
        'GetQueryResultsStream',
        'GetWorkGroup',
        'ListTagsForResource',
        'ListWorkGroups',
        'TagResource',
        'UntagResource',
        'UpdateWorkGroup',
    ],
    'autoscaling': [
        'BatchDeleteScheduledAction',
        'BatchPutScheduledUpdateGroupAction',
    ],
    'autoscaling_plans': [
        'GetScalingPlanResourceForecastData',
        'UpdateScalingPlan',
    ],
    'aws_marketplace': [
        'AcceptAgreementApprovalRequest',
        'CancelAgreementRequest',
        'GetAgreementApprovalRequest',
        'GetAgreementRequest',
        'ListAgreementApprovalRequests',
        'ListAgreementRequests',
        'RegisterUsage',
        'RejectAgreementApprovalRequest',
        'UpdateAgreementApprovalRequest',
    ],
    'aws_marketplace_management': [
        'viewSettings',
    ],
    'awslambda': [
        'AddLayerVersionPermission',
        'DeleteFunctionEventInvokeConfig',
        'DeleteLayerVersion',
        'DeleteProvisionedConcurrencyConfig',
        'DisableReplication',
        'GetFunctionConcurrency',
        'GetFunctionEventInvokeConfig',
        'GetLayerVersion',
        'GetLayerVersionPolicy',
        'GetProvisionedConcurrencyConfig',
        'ListFunctionEventInvokeConfigs',
        'ListLayerVersions',
        'ListLayers',
        'ListProvisionedConcurrencyConfigs',
        'PublishLayerVersion',
        'PutFunctionEventInvokeConfig',
        'PutProvisionedConcurrencyConfig',
        'RemoveLayerVersionPermission',
        'UpdateFunctionEventInvokeConfig',
    ],
    'ce': [
        'CreateCostCategoryDefinition',
        'DeleteCostCategoryDefinition',
        'DescribeCostCategoryDefinition',
        'GetCostAndUsageWithResources',
        'GetCostForecast',
        'GetReservationCoverage',
        'GetReservationPurchaseRecommendation',
        'GetRightsizingRecommendation',
        'GetSavingsPlansCoverage',
        'GetSavingsPlansPurchaseRecommendation',
        'GetSavingsPlansUtilization',
        'GetSavingsPlansUtilizationDetails',
        'GetUsageForecast',
        'ListCostCategoryDefinitions',
        'UpdateCostCategoryDefinition',
    ],
    'chime': [
        'AssociatePhoneNumbersWithVoiceConnector',
        'AssociatePhoneNumbersWithVoiceConnectorGroup',
        'AssociatePhoneNumberWithUser',
        'BatchDeletePhoneNumber',
        'BatchSuspendUser',
        'BatchUnsuspendUser',
        'BatchUpdatePhoneNumber',
        'BatchUpdateUser',
        'CreateApiKey',
        'CreateBot',
        'CreateBotMembership',
        'CreatePhoneNumberOrder',
        'CreateVoiceConnector',
        'CreateVoiceConnectorGroup',
        'DeleteAccountOpenIdConfig',
        'DeleteApiKey',
        'DeleteEventsConfiguration',
        'DeletePhoneNumber',
        'DeleteVoiceConnector',
        'DeleteVoiceConnectorGroup',
        'DeleteVoiceConnectorOrigination',
        'DeleteVoiceConnectorStreamingConfiguration',
        'DeleteVoiceConnectorTermination',
        'DeleteVoiceConnectorTerminationCredentials',
        'DisassociatePhoneNumberFromUser',
        'DisassociatePhoneNumbersFromVoiceConnector',
        'DisassociatePhoneNumbersFromVoiceConnectorGroup',
        'GetAccountWithOpenIdConfig',
        'GetBot',
        'GetEventsConfiguration',
        'GetGlobalSettings',
        'GetMeetingDetail',
        'GetPhoneNumber',
        'GetPhoneNumberOrder',
        'GetPhoneNumberSettings',
        'GetTelephonyLimits',
        'GetUserActivityReportData',
        'GetUserSettings',
        'GetVoiceConnector',
        'GetVoiceConnectorGroup',
        'GetVoiceConnectorLoggingConfiguration',
        'GetVoiceConnectorOrigination',
        'GetVoiceConnectorStreamingConfiguration',
        'GetVoiceConnectorTermination',
        'GetVoiceConnectorTerminationHealth',
        'ListAccountUsageReportData',
        'ListApiKeys',
        'ListBots',
        'ListCallingRegions',
        'ListMeetingEvents',
        'ListMeetingsReportData',
        'ListPhoneNumberOrders',
        'ListPhoneNumbers',
        'ListVoiceConnectorGroups',
        'ListVoiceConnectors',
        'ListVoiceConnectorTerminationCredentials',
        'PutEventsConfiguration',
        'PutVoiceConnectorLoggingConfiguration',
        'PutVoiceConnectorOrigination',
        'PutVoiceConnectorStreamingConfiguration',
        'PutVoiceConnectorTermination',
        'PutVoiceConnectorTerminationCredentials',
        'RegenerateSecurityToken',
        'ResetPersonalPIN',
        'RestorePhoneNumber',
        'RetrieveDataExports',
        'SearchAvailablePhoneNumbers',
        'StartDataExport',
        'UpdateAccount',
        'UpdateAccountOpenIdConfig',
        'UpdateBot',
        'UpdateCDRSettings',
        'UpdateGlobalSettings',
        'UpdatePhoneNumber',
        'UpdatePhoneNumberSettings',
        'UpdateUser',
        'UpdateUserSettings',
        'UpdateVoiceConnector',
        'UpdateVoiceConnectorGroup',
    ],
    'cloud9': [
        'GetUserSettings',
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
        'UpdateUserSettings',
    ],
    'clouddirectory': [
        'GetLinkAttributes',
        'GetObjectAttributes',
        'UpdateLinkAttributes',
    ],
    'cloudformation': [
        'CreateStackInstances',
        'CreateStackSet',
        'DeleteChangeSet',
        'DeleteStackInstances',
        'DeleteStackSet',
        'DescribeStackDriftDetectionStatus',
        'DescribeStackInstance',
        'DescribeStackResourceDrifts',
        'DescribeStackSet',
        'DescribeStackSetOperation',
        'DetectStackDrift',
        'DetectStackResourceDrift',
        'ListStackInstances',
        'ListStackSetOperationResults',
        'ListStackSetOperations',
        'ListStackSets',
        'StopStackSetOperation',
        'TagResource',
        'UntagResource',
        'UpdateStackInstances',
        'UpdateStackSet',
    ],
    'cloudfront': [
        'CreateFieldLevelEncryptionConfig',
        'CreateFieldLevelEncryptionProfile',
        'CreatePublicKey',
        'DeleteFieldLevelEncryptionConfig',
        'DeleteFieldLevelEncryptionProfile',
        'DeletePublicKey',
        'GetFieldLevelEncryption',
        'GetFieldLevelEncryptionConfig',
        'GetFieldLevelEncryptionProfile',
        'GetFieldLevelEncryptionProfileConfig',
        'GetPublicKey',
        'GetPublicKeyConfig',
        'ListFieldLevelEncryptionConfigs',
        'ListFieldLevelEncryptionProfiles',
        'ListPublicKeys',
        'UpdateFieldLevelEncryptionConfig',
        'UpdateFieldLevelEncryptionProfile',
        'UpdatePublicKey',
    ],
    'cloudhsm': [
        'CopyBackupToRegion',
        'CreateCluster',
        'DeleteBackup',
        'DeleteCluster',
        'DescribeBackups',
        'DescribeClusters',
        'InitializeCluster',
        'ListTags',
        'RestoreBackup',
        'TagResource',
        'UntagResource',
    ],
    'cloudsearch': [
        'DescribeDomainEndpointOptions',
        'UpdateDomainEndpointOptions',
    ],
    'cloudtrail': [
        'GetInsightSelectors',
        'GetTrail',
        'ListTrails',
        'PutInsightSelectors',
    ],
    'cloudwatch': [
        'DeleteAnomalyDetector',
        'DeleteDashboards',
        'DeleteInsightRules',
        'DescribeAnomalyDetectors',
        'DescribeInsightRules',
        'DisableInsightRules',
        'EnableInsightRules',
        'GetDashboard',
        'GetInsightRuleReport',
        'GetMetricWidgetImage',
        'ListDashboards',
        'ListTagsForResource',
        'PutAnomalyDetector',
        'PutDashboard',
        'PutInsightRule',
        'TagResource',
        'UntagResource',
    ],
    'codebuild': [
        'BatchGetReportGroups',
        'BatchGetReports',
        'BatchPutTestCases',
        'CreateReport',
        'CreateReportGroup',
        'CreateWebhook',
        'DeleteOAuthToken',
        'DeleteReport',
        'DeleteReportGroup',
        'DeleteResourcePolicy',
        'DeleteSourceCredentials',
        'DeleteWebhook',
        'DescribeTestCases',
        'GetResourcePolicy',
        'ImportSourceCredentials',
        'InvalidateProjectCache',
        'ListReportGroups',
        'ListReports',
        'ListReportsForReportGroup',
        'ListSharedProjects',
        'ListSharedReportGroups',
        'ListSourceCredentials',
        'PutResourcePolicy',
        'UpdateReport',
        'UpdateReportGroup',
        'UpdateWebhook',
    ],
    'codecommit': [
        'AssociateApprovalRuleTemplateWithRepository',
        'BatchAssociateApprovalRuleTemplateWithRepositories',
        'BatchDescribeMergeConflicts',
        'BatchDisassociateApprovalRuleTemplateFromRepositories',
        'BatchGetCommits',
        'CancelUploadArchive',
        'CreateApprovalRuleTemplate',
        'CreateCommit',
        'CreatePullRequestApprovalRule',
        'CreateUnreferencedMergeCommit',
        'DeleteApprovalRuleTemplate',
        'DeleteFile',
        'DeletePullRequestApprovalRule',
        'DescribeMergeConflicts',
        'DisassociateApprovalRuleTemplateFromRepository',
        'EvaluatePullRequestApprovalRules',
        'GetApprovalRuleTemplate',
        'GetFile',
        'GetFolder',
        'GetMergeCommit',
        'GetMergeOptions',
        'GetPullRequestApprovalStates',
        'GetPullRequestOverrideState',
        'GetUploadArchiveStatus',
        'ListApprovalRuleTemplates',
        'ListAssociatedApprovalRuleTemplatesForRepository',
        'ListRepositoriesForApprovalRuleTemplate',
        'ListTagsForResource',
        'MergeBranchesByFastForward',
        'MergeBranchesBySquash',
        'MergeBranchesByThreeWay',
        'MergePullRequestBySquash',
        'MergePullRequestByThreeWay',
        'OverridePullRequestApprovalRules',
        'TagResource',
        'UntagResource',
        'UpdateApprovalRuleTemplateContent',
        'UpdateApprovalRuleTemplateDescription',
        'UpdateApprovalRuleTemplateName',
        'UpdatePullRequestApprovalRuleContent',
        'UpdatePullRequestApprovalState',
        'UploadArchive',
    ],
    'codedeploy': [
        'BatchGetDeploymentTargets',
        'DeleteGitHubAccountToken',
        'GetDeploymentTarget',
        'ListDeploymentTargets',
        'ListGitHubAccountTokenNames',
        'ListTagsForResource',
        'PutLifecycleEventHookExecutionStatus',
        'SkipWaitTimeForInstanceTermination',
        'TagResource',
        'UntagResource',
    ],
    'codepipeline': [
        'DeleteWebhook',
        'DeregisterWebhookWithThirdParty',
        'ListActionExecutions',
        'ListTagsForResource',
        'ListWebhooks',
        'PutWebhook',
        'RegisterWebhookWithThirdParty',
        'TagResource',
        'UntagResource',
    ],
    'codestar': [
        'ListTagsForProject',
        'TagProject',
        'UntagProject',
    ],
    'codeartifact': [
        'AssociateExternalConnection',
        'AssociateWithDownstreamRepository',
        'CopyPackageVersions',
        'CreateDomain',
        'CreateRepository',
        'DeleteDomain',
        'DeleteDomainPermissionsPolicy',
        'DeletePackageVersions',
        'DeleteRepository',
        'DeleteRepositoryPermissionsPolicy',
        'DescribeDomain',
        'DescribePackageVersion',
        'DescribeRepository',
        'DisassociateExternalConnection',
        'DisposePackageVersions',
        'GetAuthorizationToken',
        'GetDomainPermissionsPolicy',
        'GetPackageVersionAsset',
        'GetPackageVersionReadme',
        'GetRepositoryEndpoint',
        'GetRepositoryPermissionsPolicy',
        'ListDomains',
        'ListPackageVersionAssets',
        'ListPackageVersionDependencies',
        'ListPackageVersions',
        'ListPackages',
        'ListRepositories',
        'ListRepositoriesInDomain',
        'PublishPackageVersion',
        'PutDomainPermissionsPolicy',
        'PutPackageMetadata',
        'PutRepositoryPermissionsPolicy',
        'ReadFromRepository',
        'UpdatePackageVersionsStatus',
        'UpdateRepository'
    ],
    'cognito_identity': [
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
    ],
    'cognito_idp': [
        'AdminDisableProviderForUser',
        'AdminLinkProviderForUser',
        'AdminSetUserPassword',
        'AssociateSoftwareToken',
        'CreateIdentityProvider',
        'CreateResourceServer',
        'CreateUserPoolDomain',
        'DeleteIdentityProvider',
        'DeleteResourceServer',
        'DeleteUserPoolDomain',
        'DescribeIdentityProvider',
        'DescribeResourceServer',
        'DescribeUserPoolDomain',
        'GetIdentityProviderByIdentifier',
        'GetSigningCertificate',
        'GetUICustomization',
        'ListIdentityProviders',
        'ListResourceServers',
        'ListTagsForResource',
        'SetUICustomization',
        'TagResource',
        'UntagResource',
        'UpdateIdentityProvider',
        'UpdateResourceServer',
        'UpdateUserPoolDomain',
        'VerifySoftwareToken',
    ],
    'comprehend': [
        'BatchDetectSyntax',
        'ClassifyDocument',
        'CreateDocumentClassifier',
        'CreateEndpoint',
        'CreateEntityRecognizer',
        'DeleteDocumentClassifier',
        'DeleteEndpoint',
        'DeleteEntityRecognizer',
        'DescribeDocumentClassificationJob',
        'DescribeDocumentClassifier',
        'DescribeDominantLanguageDetectionJob',
        'DescribeEndpoint',
        'DescribeEntitiesDetectionJob',
        'DescribeEntityRecognizer',
        'DescribeKeyPhrasesDetectionJob',
        'DescribeSentimentDetectionJob',
        'DetectSyntax',
        'ListDocumentClassificationJobs',
        'ListDocumentClassifiers',
        'ListDominantLanguageDetectionJobs',
        'ListEndpoints',
        'ListEntitiesDetectionJobs',
        'ListEntityRecognizers',
        'ListKeyPhrasesDetectionJobs',
        'ListSentimentDetectionJobs',
        'ListTagsForResource',
        'StartDocumentClassificationJob',
        'StartDominantLanguageDetectionJob',
        'StartEntitiesDetectionJob',
        'StartKeyPhrasesDetectionJob',
        'StartSentimentDetectionJob',
        'StopDominantLanguageDetectionJob',
        'StopEntitiesDetectionJob',
        'StopKeyPhrasesDetectionJob',
        'StopSentimentDetectionJob',
        'StopTrainingDocumentClassifier',
        'StopTrainingEntityRecognizer',
        'TagResource',
        'UntagResource',
        'UpdateEndpoint',
    ],
    'config': [
        'BatchGetAggregateResourceConfig',
        'BatchGetResourceConfig',
        'DeleteAggregationAuthorization',
        'DeleteConfigurationAggregator',
        'DeleteConformancePack',
        'DeleteOrganizationConfigRule',
        'DeleteOrganizationConformancePack',
        'DeletePendingAggregationRequest',
        'DeleteRemediationConfiguration',
        'DeleteRemediationExceptions',
        'DeleteRetentionConfiguration',
        'DescribeAggregateComplianceByConfigRules',
        'DescribeAggregationAuthorizations',
        'DescribeConfigurationAggregatorSourcesStatus',
        'DescribeConfigurationAggregators',
        'DescribeConformancePackCompliance',
        'DescribeConformancePacks',
        'DescribeConformancePackStatus',
        'DescribeOrganizationConfigRules',
        'DescribeOrganizationConfigRuleStatuses',
        'DescribeOrganizationConformancePacks',
        'DescribeOrganizationConformancePackStatuses',
        'DescribePendingAggregationRequests',
        'DescribeRemediationConfigurations',
        'DescribeRemediationExceptions',
        'DescribeRemediationExecutionStatus',
        'DescribeRetentionConfigurations',
        'GetAggregateComplianceDetailsByConfigRule',
        'GetAggregateConfigRuleComplianceSummary',
        'GetAggregateDiscoveredResourceCounts',
        'GetAggregateResourceConfig',
        'GetConformancePackComplianceDetails',
        'GetConformancePackComplianceSummary',
        'GetDiscoveredResourceCounts',
        'GetOrganizationConfigRuleDetailedStatus',
        'GetOrganizationConformancePackDetailedStatus',
        'ListAggregateDiscoveredResources',
        'ListTagsForResource',
        'PutAggregationAuthorization',
        'PutConfigurationAggregator',
        'PutConformancePack',
        'PutOrganizationConfigRule',
        'PutOrganizationConformancePack',
        'PutRemediationConfigurations',
        'PutRemediationExceptions',
        'PutRetentionConfiguration',
        'SelectResourceConfig',
        'StartRemediationExecution',
        'TagResource',
        'UntagResource',
    ],
    'connect': [
        'CreateUser',
        'DeleteUser',
        'DescribeUser',
        'DescribeUserHierarchyGroup',
        'DescribeUserHierarchyStructure',
        'GetContactAttributes',
        'GetCurrentMetricData',
        'GetMetricData',
        'ListContactFlows',
        'ListHoursOfOperations',
        'ListPhoneNumbers',
        'ListQueues',
        'ListRoutingProfiles',
        'ListSecurityProfiles',
        'ListTagsForResource',
        'ListUserHierarchyGroups',
        'ListUsers',
        'StartChatContact',
        'StartOutboundVoiceContact',
        'StopContact',
        'TagResource',
        'UntagResource',
        'UpdateContactAttributes',
        'UpdateUserHierarchy',
        'UpdateUserIdentityInfo',
        'UpdateUserPhoneConfig',
        'UpdateUserRoutingProfile',
        'UpdateUserSecurityProfiles',
    ],
    'crowd': [
        'AcceptQualificationRequest',
        'ApproveAssignment',
        'ApproveRejectedAssignment',
        'AssignQualification',
        'AssociateQualificationWithWorker',
        'BlockWorker',
        'ChangeHITTypeOfHIT',
        'CreateAdditionalAssignmentsForHIT',
        'CreateHIT',
        'CreateHITType',
        'CreateHITWithHITType',
        'CreateQualificationType',
        'CreateWorkerBlock',
        'DeleteHIT',
        'DeleteQualificationType',
        'DeleteWorkerBlock',
        'DisableHIT',
        'DisassociateQualificationFromWorker',
        'DisposeHIT',
        'DisposeQualificationType',
        'ExtendHIT',
        'ForceExpireHIT',
        'GetAccountBalance',
        'GetAssignment',
        'GetAssignmentsForHIT',
        'GetBlockedWorkers',
        'GetBonusPayments',
        'GetFileUploadURL',
        'GetHIT',
        'GetHITsForQualificationType',
        'GetQualificationRequests',
        'GetQualificationScore',
        'GetQualificationType',
        'GetQualificationsForQualificationType',
        'GetRequesterStatistic',
        'GetRequesterWorkerStatistic',
        'GetReviewResultsForHIT',
        'GetReviewableHITs',
        'GrantBonus',
        'GrantQualification',
        'ListAssignmentsForHIT',
        'ListBonusPayments',
        'ListHITs',
        'ListHITsForQualificationType',
        'ListQualificationRequests',
        'ListQualificationTypes',
        'ListReviewableHITs',
        'ListReviewPolicyResultsForHIT',
        'ListWorkerBlocks',
        'ListWorkersWithQualificationType',
        'NotifyWorkers',
        'RegisterHITType',
        'RejectAssignment',
        'RejectQualificationRequest',
        'RevokeQualification',
        'SearchHITs',
        'SearchQualificationTypes',
        'SendBonus',
        'SendTestEventNotification',
        'SetHITAsReviewing',
        'SetHITTypeNotification',
        'UnblockWorker',
        'UpdateExpirationForHIT',
        'UpdateHITReviewStatus',
        'UpdateHITTypeOfHIT',
        'UpdateNotificationSettings',
        'UpdateQualificationScore',
        'UpdateQualificationType',
    ],
    'cur': [
        'ModifyReportDefinition',
    ],
    'dax': [
        'ConditionCheckItem',
    ],
    'devicefarm': [
        'CreateInstanceProfile',
        'CreateVPCEConfiguration',
        'DeleteInstanceProfile',
        'DeleteVPCEConfiguration',
        'GetDeviceInstance',
        'GetInstanceProfile',
        'GetVPCEConfiguration',
        'ListDeviceInstances',
        'ListInstanceProfiles',
        'ListOfferingPromotions',
        'ListTagsForResource',
        'ListVPCEConfigurations',
        'StopJob',
        'TagResource',
        'UntagResource',
        'UpdateDeviceInstance',
        'UpdateInstanceProfile',
        'UpdateUpload',
        'UpdateVPCEConfiguration',
    ],
    'directconnect': [
        'AcceptDirectConnectGatewayAssociationProposal',
        'AllocateHostedConnection',
        'AllocateTransitVirtualInterface',
        'AssociateConnectionWithLag',
        'AssociateHostedConnection',
        'AssociateVirtualInterface',
        'ConfirmTransitVirtualInterface',
        'CreateBGPPeer',
        'CreateDirectConnectGateway',
        'CreateDirectConnectGatewayAssociation',
        'CreateDirectConnectGatewayAssociationProposal',
        'CreateLag',
        'CreateTransitVirtualInterface',
        'DeleteBGPPeer',
        'DeleteDirectConnectGateway',
        'DeleteDirectConnectGatewayAssociation',
        'DeleteDirectConnectGatewayAssociationProposal',
        'DeleteLag',
        'DescribeDirectConnectGatewayAssociationProposals',
        'DescribeDirectConnectGatewayAssociations',
        'DescribeDirectConnectGatewayAttachments',
        'DescribeDirectConnectGateways',
        'DescribeHostedConnections',
        'DescribeLags',
        'DescribeLoa',
        'DescribeTags',
        'DisassociateConnectionFromLag',
        'TagResource',
        'UntagResource',
        'UpdateDirectConnectGatewayAssociation',
        'UpdateLag',
        'UpdateVirtualInterfaceAttributes',
    ],
    'discovery': [
        'BatchDeleteImportData',
        'DescribeContinuousExports',
        'DescribeExportTasks',
        'DescribeImportTasks',
        'StartContinuousExport',
        'StartImportTask',
        'StopContinuousExport',
    ],
    'dlm': [
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
    ],
    'dms': [
        'ApplyPendingMaintenanceAction',
        'CreateEventSubscription',
        'DeleteCertificate',
        'DescribeReplicationInstanceTaskLogs',
        'DescribeReplicationTaskAssessmentResults',
        'ImportCertificate',
        'RebootReplicationInstance',
        'ReloadTables',
        'StartReplicationTaskAssessment',
    ],
    'ds': [
        'AcceptSharedDirectory',
        'CheckAlias',
        'CreateIdentityPoolDirectory',
        'CreateLogSubscription',
        'DeleteLogSubscription',
        'DeregisterCertificate',
        'DescribeCertificate',
        'DescribeDomainControllers',
        'DescribeLDAPSSettings',
        'DescribeSharedDirectories',
        'DisableLDAPS',
        'EnableLDAPS',
        'GetAuthorizedApplicationDetails',
        'ListCertificates',
        'ListLogSubscriptions',
        'RegisterCertificate',
        'RejectSharedDirectory',
        'ResetUserPassword',
        'ShareDirectory',
        'UnshareDirectory',
        'UpdateNumberOfDomainControllers',
        'UpdateTrust',
    ],
    'dynamodb': [
        'ConditionCheckItem',
        'CreateGlobalTable',
        'CreateTableReplica',
        'DeleteTableReplica',
        'DescribeContributorInsights',
        'DescribeGlobalTable',
        'DescribeGlobalTableSettings',
        'DescribeTableReplicaAutoScaling',
        'DescribeTimeToLive',
        'ListContributorInsights',
        'ListGlobalTables',
        'UpdateContributorInsights',
        'UpdateGlobalTable',
        'UpdateGlobalTableSettings',
        'UpdateTableReplicaAutoScaling',
        'UpdateTimeToLive',
    ],
    'ec2': [
        'AcceptTransitGatewayVpcAttachment',
        'AdvertiseByoipCidr',
        'ApplySecurityGroupsToClientVpnTargetNetwork',
        'AssociateClientVpnTargetNetwork',
        'AssociateTransitGatewayRouteTable',
        'AuthorizeClientVpnIngress',
        'CancelCapacityReservation',
        'CreateCapacityReservation',
        'CreateClientVpnEndpoint',
        'CreateClientVpnRoute',
        'CreateFleet',
        'CreateSnapshots',
        'CreateTrafficMirrorFilter',
        'CreateTrafficMirrorFilterRule',
        'CreateTrafficMirrorSession',
        'CreateTrafficMirrorTarget',
        'CreateTransitGateway',
        'CreateTransitGatewayRoute',
        'CreateTransitGatewayRouteTable',
        'CreateTransitGatewayVpcAttachment',
        'DeleteClientVpnEndpoint',
        'DeleteClientVpnRoute',
        'DeleteFleets',
        'DeleteTrafficMirrorFilter',
        'DeleteTrafficMirrorFilterRule',
        'DeleteTrafficMirrorSession',
        'DeleteTrafficMirrorTarget',
        'DeleteTransitGateway',
        'DeleteTransitGatewayRoute',
        'DeleteTransitGatewayRouteTable',
        'DeleteTransitGatewayVpcAttachment',
        'DeprovisionByoipCidr',
        'DescribeAggregateIdFormat',
        'DescribeByoipCidrs',
        'DescribeCapacityReservations',
        'DescribeClientVpnAuthorizationRules',
        'DescribeClientVpnConnections',
        'DescribeClientVpnEndpoints',
        'DescribeClientVpnRoutes',
        'DescribeClientVpnTargetNetworks',
        'DescribeFleetHistory',
        'DescribeFleetInstances',
        'DescribeFleets',
        'DescribePrincipalIdFormat',
        'DescribePublicIpv4Pools',
        'DescribeTrafficMirrorFilters',
        'DescribeTrafficMirrorSessions',
        'DescribeTrafficMirrorTargets',
        'DescribeTransitGatewayAttachments',
        'DescribeTransitGatewayRouteTables',
        'DescribeTransitGatewayVpcAttachments',
        'DescribeTransitGateways',
        'DisableEbsEncryptionByDefault',
        'DisableTransitGatewayRouteTablePropagation',
        'DisassociateClientVpnTargetNetwork',
        'DisassociateTransitGatewayRouteTable',
        'EnableEbsEncryptionByDefault',
        'EnableTransitGatewayRouteTablePropagation',
        'ExportClientVpnClientCertificateRevocationList',
        'ExportClientVpnClientConfiguration',
        'ExportTransitGatewayRoutes',
        'GetCapacityReservationUsage',
        'GetEbsDefaultKmsKeyId',
        'GetEbsEncryptionByDefault',
        'GetTransitGatewayAttachmentPropagations',
        'GetTransitGatewayRouteTableAssociations',
        'GetTransitGatewayRouteTablePropagations',
        'ImportClientVpnClientCertificateRevocationList',
        'ModifyCapacityReservation',
        'ModifyClientVpnEndpoint',
        'ModifyEbsDefaultKmsKeyId',
        'ModifyFleet',
        'ModifyInstanceCapacityReservationAttributes',
        'ModifyInstanceEventStartTime',
        'ModifyTrafficMirrorFilterNetworkServices',
        'ModifyTrafficMirrorFilterRule',
        'ModifyTrafficMirrorSession',
        'ModifyTransitGatewayVpcAttachment',
        'ModifyVpnConnection',
        'ProvisionByoipCidr',
        'RejectTransitGatewayVpcAttachment',
        'ReplaceTransitGatewayRoute',
        'ResetEbsDefaultKmsKeyId',
        'RevokeClientVpnIngress',
        'SearchTransitGatewayRoutes',
        'SendDiagnosticInterrupt',
        'TerminateClientVpnConnections',
        'WithdrawByoipCidr',
    ],
    'ecr': [
        'DeleteLifecyclePolicy',
        'DescribeImageScanFindings',
        'GetLifecyclePolicy',
        'GetLifecyclePolicyPreview',
        'ListTagsForResource',
        'PutImageScanningConfiguration',
        'PutImageTagMutability',
        'PutLifecyclePolicy',
        'StartImageScan',
        'StartLifecyclePolicyPreview',
        'TagResource',
        'UntagResource',
    ],
    'ecs': [
        'CreateTaskSet',
        'DeleteAccountSetting',
        'DeleteAccountSettings',
        'DeleteAttributes',
        'DeleteTaskSet',
        'DescribeTaskSets',
        'ListAccountSettings',
        'ListAttributes',
        'ListTagsForResource',
        'PutAccountSetting',
        'PutAccountSettingDefault',
        'PutAttributes',
        'SubmitAttachmentStateChanges',
        'TagResource',
        'UntagResource',
        'UpdateServicePrimaryTaskSet',
        'UpdateTaskSet',
    ],
    'eks': [
        'CreateFargateProfile',
        'CreateNodegroup',
        'DeleteFargateProfile',
        'DeleteNodegroup',
        'DescribeFargateProfile',
        'DescribeNodegroup',
        'ListFargateProfiles',
        'ListNodegroups',
        'UpdateNodegroupConfig',
        'UpdateNodegroupVersion',
    ],
    'elasticache': [
        'DecreaseReplicaCount',
        'IncreaseReplicaCount',
        'ModifyReplicationGroupShardConfiguration',
        'TestFailover',
    ],
    'elasticbeanstalk': [
        'DescribeAccountAttributes',
    ],
    'elasticfilesystem': [
        'Backup',
        'ClientMount',
        'ClientRootAccess',
        'ClientWrite',
        'CreateAccessPoint',
        'DeleteAccessPoint',
        'DeleteFileSystemPolicy',
        'DescribeAccessPoints',
        'DescribeFileSystemPolicy',
        'DescribeLifecycleConfiguration',
        'ListTagsForResource',
        'PutFileSystemPolicy',
        'PutLifecycleConfiguration',
        'Restore',
        'TagResource',
        'UntagResource',
        'UpdateFileSystem',
    ],
    'elasticmapreduce': [
        'AddInstanceFleet',
        'CreateEditor',
        'DeleteEditor',
        'DescribeEditor',
        'GetBlockPublicAccessConfiguration',
        'ListEditors',
        'ListInstanceFleets',
        'ModifyInstanceFleet',
        'OpenEditorInConsole',
        'PutBlockPublicAccessConfiguration',
        'StartEditor',
        'StopEditor',
    ],
    'es': [
        'DeleteElasticsearchServiceRole',
        'DescribeElasticsearchInstanceTypeLimits',
        'DescribeReservedElasticsearchInstanceOfferings',
        'DescribeReservedElasticsearchInstances',
        'ESHttpDelete',
        'ESHttpGet',
        'ESHttpHead',
        'ESHttpPatch',
        'ESHttpPost',
        'ESHttpPut',
        'GetCompatibleElasticsearchVersions',
        'GetUpgradeHistory',
        'GetUpgradeStatus',
        'ListElasticsearchInstanceTypes',
        'ListElasticsearchVersions',
        'PurchaseReservedElasticsearchInstance',
        'PurchaseReservedElasticsearchInstanceOffering',
        'UpgradeElasticsearchDomain',
    ],
    'events': [
        'ActivateEventSource',
        'CreateEventBus',
        'CreatePartnerEventSource',
        'DeactivateEventSource',
        'DeleteEventBus',
        'DeletePartnerEventSource',
        'DescribeEventBus',
        'DescribeEventSource',
        'DescribePartnerEventSource',
        'ListEventBuses',
        'ListEventSources',
        'ListPartnerEventSourceAccounts',
        'ListPartnerEventSources',
        'ListTagsForResource',
        'PutPartnerEvents',
        'PutPermission',
        'RemovePermission',
        'TagResource',
        'UntagResource',
    ],
    'execute_api': [
        'ManageConnections',
    ],
    'firehose': [
        'ListTagsForDeliveryStream', 'StartDeliveryStreamEncryption',
        'StopDeliveryStreamEncryption', 'TagDeliveryStream',
        'UntagDeliveryStream',
    ],
    'fms': [
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
    ],
    'fsx': [
        'CancelDataRepositoryTask',
        'CreateDataRepositoryTask',
        'DescribeDataRepositoryTasks',
    ],
    'gamelift': [
        'AcceptMatch',
        'CreateGameSessionQueue',
        'CreateMatchmakingConfiguration',
        'CreateMatchmakingRuleSet',
        'CreateScript',
        'CreateVpcPeeringAuthorization',
        'CreateVpcPeeringConnection',
        'DeleteGameSessionQueue',
        'DeleteMatchmakingConfiguration',
        'DeleteMatchmakingRuleSet',
        'DeleteScript',
        'DeleteVpcPeeringAuthorization',
        'DeleteVpcPeeringConnection',
        'DescribeGameSessionPlacement',
        'DescribeGameSessionQueues',
        'DescribeMatchmaking',
        'DescribeMatchmakingConfigurations',
        'DescribeMatchmakingRuleSets',
        'DescribeScript',
        'DescribeVpcPeeringAuthorizations',
        'DescribeVpcPeeringConnections',
        'ListScripts',
        'ListTagsForResource',
        'StartFleetActions',
        'StartGameSessionPlacement',
        'StartMatchBackfill',
        'StartMatchmaking',
        'StopFleetActions',
        'StopGameSessionPlacement',
        'StopMatchmaking',
        'TagResource',
        'UntagResource',
        'UpdateGameSessionQueue',
        'UpdateMatchmakingConfiguration',
        'UpdateScript',
        'ValidateMatchmakingRuleSet',
    ],
    'glue': [
        'BatchDeleteTableVersion',
        'BatchGetCrawlers',
        'BatchGetDevEndpoints',
        'BatchGetJobs',
        'BatchGetTriggers',
        'BatchGetWorkflows',
        'BatchStopJobRun',
        'CancelMLTaskRun',
        'CreateMLTransform',
        'CreateWorkflow',
        'DeleteMLTransform',
        'DeleteResourcePolicy',
        'DeleteTableVersion',
        'DeleteWorkflow',
        'GetJobBookmark',
        'GetMLTaskRun',
        'GetMLTaskRuns',
        'GetMLTransform',
        'GetMLTransforms',
        'GetResourcePolicy',
        'GetTableVersion',
        'GetTags',
        'GetWorkflow',
        'GetWorkflowRun',
        'GetWorkflowRunProperties',
        'GetWorkflowRuns',
        'ListCrawlers',
        'ListDevEndpoints',
        'ListJobs',
        'ListTriggers',
        'ListWorkflows',
        'PutResourcePolicy',
        'PutWorkflowRunProperties',
        'SearchTables',
        'StartExportLabelsTaskRun',
        'StartImportLabelsTaskRun',
        'StartMLEvaluationTaskRun',
        'StartMLLabelingSetGenerationTaskRun',
        'StartWorkflowRun',
        'TagResource',
        'UntagResource',
        'UpdateCrawlerSchedule',
        'UpdateMLTransform',
        'UpdateWorkflow',
        'UseMLTransforms',
    ],
    'greengrass': [
        'CreateConnectorDefinition',
        'CreateConnectorDefinitionVersion',
        'DeleteConnectorDefinition',
        'GetBulkDeploymentStatus',
        'GetConnectorDefinition',
        'GetConnectorDefinitionVersion',
        'ListBulkDeploymentDetailedReports',
        'ListBulkDeployments',
        'ListConnectorDefinitionVersions',
        'ListConnectorDefinitions',
        'ListTagsForResource',
        'StartBulkDeployment',
        'StopBulkDeployment',
        'TagResource',
        'UntagResource',
        'UpdateConnectorDefinition',
    ],
    'guardduty': [
        'CreateFilter',
        'CreatePublishingDestination',
        'DeleteFilter',
        'DeletePublishingDestination',
        'DescribePublishingDestination',
        'GetFilter',
        'ListFilters',
        'ListPublishingDestinations',
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
        'UpdateFilter',
        'UpdatePublishingDestination',
    ],
    'health': [
        'DescribeAffectedAccountsForOrganization',
        'DescribeAffectedEntitiesForOrganization',
        'DescribeEventDetailsForOrganization',
        'DescribeEventsForOrganization',
        'DescribeHealthServiceStatusForOrganization',
        'DisableHealthServiceAccessForOrganization',
        'EnableHealthServiceAccessForOrganization',
    ],
    'iam': [
        'DeleteRolePermissionsBoundary',
        'DeleteUserPermissionsBoundary',
        'FinalizeSmsMfaRegistration',
        'GenerateOrganizationsAccessReport',
        'GetOrganizationsAccessReport',
        'ListRoleTags',
        'ListUserTags',
        'PutRolePermissionsBoundary',
        'PutUserPermissionsBoundary',
        'RequestSmsMfaRegistration',
        'SetSecurityTokenServicePreferences',
        'TagRole',
        'TagUser',
        'UntagRole',
        'UntagUser',
        'UpdateRole',
    ],
    'iot': [
        'AddThingToBillingGroup',
        'AddThingToThingGroup',
        'AttachSecurityProfile',
        'CancelAuditTask',
        'CancelJobExecution',
        'CreateBillingGroup',
        'CreateDynamicThingGroup',
        'CreateOTAUpdate',
        'CreateScheduledAudit',
        'CreateSecurityProfile',
        'CreateThingGroup',
        'DeleteAccountAuditConfiguration',
        'DeleteBillingGroup',
        'DeleteDynamicThingGroup',
        'DeleteJob',
        'DeleteJobExecution',
        'DeleteOTAUpdate',
        'DeleteScheduledAudit',
        'DeleteSecurityProfile',
        'DeleteThingGroup',
        'DeleteV2LoggingLevel',
        'DescribeAccountAuditConfiguration',
        'DescribeAuditTask',
        'DescribeBillingGroup',
        'DescribeEventConfigurations',
        'DescribeScheduledAudit',
        'DescribeSecurityProfile',
        'DescribeThingGroup',
        'DescribeThingRegistrationTask',
        'DetachSecurityProfile',
        'GetOTAUpdate',
        'GetPendingJobExecutions',
        'GetStatistics',
        'GetV2LoggingOptions',
        'ListActiveViolations',
        'ListAuditFindings',
        'ListAuditTasks',
        'ListBillingGroups',
        'ListOTAUpdates',
        'ListScheduledAudits',
        'ListSecurityProfiles',
        'ListSecurityProfilesForTarget',
        'ListTagsForResource',
        'ListTargetsForSecurityProfile',
        'ListThingGroups',
        'ListThingGroupsForThing',
        'ListThingRegistrationTaskReports',
        'ListThingRegistrationTasks',
        'ListThingsInBillingGroup',
        'ListThingsInThingGroup',
        'ListV2LoggingLevels',
        'ListViolationEvents',
        'RegisterThing',
        'RemoveThingFromBillingGroup',
        'RemoveThingFromThingGroup',
        'SetV2LoggingLevel',
        'SetV2LoggingOptions',
        'StartNextPendingJobExecution',
        'StartOnDemandAuditTask',
        'StartThingRegistrationTask',
        'StopThingRegistrationTask',
        'TagResource',
        'UntagResource',
        'UpdateAccountAuditConfiguration',
        'UpdateBillingGroup',
        'UpdateDynamicThingGroup',
        'UpdateEventConfigurations',
        'UpdateJob',
        'UpdateJobExecution',
        'UpdateScheduledAudit',
        'UpdateSecurityProfile',
        'UpdateThingGroup',
        'UpdateThingGroupsForThing',
        'ValidateSecurityProfileBehaviors',
    ],
    'iotanalytics': [
        'BatchPutMessage',
        'CancelPipelineReprocessing',
        'DescribeLoggingOptions',
        'ListTagsForResource',
        'PutLoggingOptions',
        'RunPipelineActivity',
        'SampleChannelData',
        'StartPipelineReprocessing',
        'TagResource',
        'UntagResource',
        'UpdateChannel',
        'UpdateDatastore',
    ],
    'kinesis': [
        'DeregisterStreamConsumer', 'DescribeStreamConsumer',
        'DescribeStreamSummary', 'ListShards', 'ListStreamConsumers',
        'RegisterStreamConsumer', 'SubscribeToShard',
    ],
    'kinesisvideo': [
        'ConnectAsMaster',
        'ConnectAsViewer',
        'CreateSignalingChannel',
        'DeleteSignalingChannel',
        'DescribeSignalingChannel',
        'GetDASHStreamingSessionURL',
        'GetHLSStreamingSessionURL',
        'GetIceServerConfig',
        'GetSignalingChannelEndpoint',
        'ListSignalingChannels',
        'ListTagsForResource',
        'SendAlexaOfferToMaster',
        'TagResource',
        'UntagResource',
        'UpdateSignalingChannel',
    ],
    'lightsail': [
        'AttachDisk',
        'AttachInstancesToLoadBalancer',
        'AttachLoadBalancerTlsCertificate',
        'CopySnapshot',
        'CreateCloudFormationStack',
        'CreateDisk',
        'CreateDiskFromSnapshot',
        'CreateDiskSnapshot',
        'CreateLoadBalancer',
        'CreateLoadBalancerTlsCertificate',
        'CreateRelationalDatabase',
        'CreateRelationalDatabaseFromSnapshot',
        'CreateRelationalDatabaseSnapshot',
        'DeleteDisk',
        'DeleteDiskSnapshot',
        'DeleteKnownHostKeys',
        'DeleteLoadBalancer',
        'DeleteLoadBalancerTlsCertificate',
        'DeleteRelationalDatabase',
        'DeleteRelationalDatabaseSnapshot',
        'DetachDisk',
        'DetachInstancesFromLoadBalancer',
        'ExportSnapshot',
        'GetCloudFormationStackRecords',
        'GetDisk',
        'GetDiskSnapshot',
        'GetDiskSnapshots',
        'GetDisks',
        'GetExportSnapshotRecords',
        'GetLoadBalancer',
        'GetLoadBalancerMetricData',
        'GetLoadBalancerTlsCertificates',
        'GetLoadBalancers',
        'GetRelationalDatabase',
        'GetRelationalDatabaseBlueprints',
        'GetRelationalDatabaseBundles',
        'GetRelationalDatabaseEvents',
        'GetRelationalDatabaseLogEvents',
        'GetRelationalDatabaseLogStreams',
        'GetRelationalDatabaseMasterUserPassword',
        'GetRelationalDatabaseMetricData',
        'GetRelationalDatabaseParameters',
        'GetRelationalDatabaseSnapshot',
        'GetRelationalDatabaseSnapshots',
        'GetRelationalDatabases',
        'PutInstancePublicPorts',
        'RebootRelationalDatabase',
        'StartRelationalDatabase',
        'StopRelationalDatabase',
        'TagResource',
        'UntagResource',
        'UpdateLoadBalancerAttribute',
        'UpdateRelationalDatabase',
        'UpdateRelationalDatabaseParameters',
    ],
    'logs': [
        'CreateLogDelivery',
        'DeleteLogDelivery',
        'DescribeQueries',
        'GetLogDelivery',
        'GetLogGroupFields',
        'GetLogRecord',
        'GetQueryResults',
        'ListLogDeliveries',
        'StartQuery',
        'StopQuery',
        'UpdateLogDelivery',
    ],
    'mechanicalturk': [
        'CreateAdditionalAssignmentsForHIT',
    ],
    'mediaconvert': [
        'AssociateCertificate',
        'DescribeEndpoints',
        'DisassociateCertificate',
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
    ],
    'medialive': [
        'BatchUpdateSchedule',
        'CreateMultiplex',
        'CreateTags',
        'DeleteMultiplex',
        'DeleteReservation',
        'DeleteTags',
        'DescribeMultiplex',
        'DescribeOffering',
        'DescribeReservation',
        'DescribeSchedule',
        'ListMultiplexes',
        'ListOfferings',
        'ListReservations',
        'ListTagsForResource',
        'PurchaseOffering',
        'StartMultiplex',
        'StopMultiplex',
        'UpdateChannel',
        'UpdateChannelClass',
        'UpdateInput',
        'UpdateInputSecurityGroup',
        'UpdateMultiplex',
        'UpdateReservation',
    ],
    'mediapackage': [
        'ListTagsForResource',
        'RotateIngestEndpointCredentials',
        'TagResource',
        'UntagResource',
    ],
    'mediastore': [
        'DeleteCorsPolicy',
        'DeleteLifecyclePolicy',
        'GetCorsPolicy',
        'GetLifecyclePolicy',
        'PutCorsPolicy',
        'PutLifecyclePolicy',
        'StartAccessLogging',
        'StopAccessLogging',
    ],
    'mgh': [
        'CreateHomeRegionControl',
        'DescribeHomeRegionControls',
        'GetHomeRegion',
    ],
    'mobilehub': [
        'DeleteProjectSnapshot',
        'InstallBundle',
        'ListProjectSnapshots',
    ],
    'mobiletargeting': [
        'CreateApp',
        'CreateEmailTemplate',
        'CreateExportJob',
        'CreateJourney',
        'CreatePushTemplate',
        'CreateSmsTemplate',
        'CreateVoiceTemplate',
        'DeleteApnsVoipChannel',
        'DeleteApnsVoipSandboxChannel',
        'DeleteApp',
        'DeleteBaiduChannel',
        'DeleteEmailChannel',
        'DeleteEmailTemplate',
        'DeleteEndpoint',
        'DeleteEventStream',
        'DeleteJourney',
        'DeletePushTemplate',
        'DeleteSmsChannel',
        'DeleteSmsTemplate',
        'DeleteUserEndpoints',
        'DeleteVoiceChannel',
        'DeleteVoiceTemplate',
        'GetApnsVoipChannel',
        'GetApnsVoipSandboxChannel',
        'GetApp',
        'GetApps',
        'GetBaiduChannel',
        'GetChannels',
        'GetEmailChannel',
        'GetEmailTemplate',
        'GetEventStream',
        'GetExportJob',
        'GetExportJobs',
        'GetJourney',
        'GetPushTemplate',
        'GetSegmentExportJobs',
        'GetSmsChannel',
        'GetSmsTemplate',
        'GetUserEndpoints',
        'GetVoiceChannel',
        'GetVoiceTemplate',
        'ListJourneys',
        'ListTagsForResource',
        'ListTemplates',
        'ListTemplateVersions',
        'PhoneNumberValidate',
        'PutEventStream',
        'PutEvents',
        'RemoveAttributes',
        'SendMessages',
        'SendUsersMessages',
        'TagResource',
        'UntagResource',
        'UpdateApnsVoipChannel',
        'UpdateApnsVoipSandboxChannel',
        'UpdateBaiduChannel',
        'UpdateEmailChannel',
        'UpdateEmailTemplate',
        'UpdateJourney',
        'UpdateJourneyState',
        'UpdatePushTemplate',
        'UpdateSmsChannel',
        'UpdateSmsTemplate',
        'UpdateTemplateActiveVersion',
        'UpdateVoiceChannel',
        'UpdateVoiceTemplate',
    ],
    'mq': [
        'CreateTags',
        'DeleteTags',
        'DescribeBrokerEngineTypes',
        'DescribeBrokerInstanceOptions',
        'ListTags',
    ],
    'organizations': [
        'CreateGovCloudAccount',
        'DescribeEffectivePolicy',
        'DisableAWSServiceAccess',
        'EnableAWSServiceAccess',
        'ListAWSServiceAccessForOrganization',
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
    ],
    'polly': [
        'GetSpeechSynthesisTask',
        'ListSpeechSynthesisTasks',
        'StartSpeechSynthesisTask',
    ],
    'rds': [
        'AddRoleToDBInstance',
        'BacktrackDBCluster',
        'CancelExportTask',
        'CopyDBClusterParameterGroup',
        'CreateDBClusterEndpoint',
        'CreateDBProxy',
        'CreateGlobalCluster',
        'DeleteDBClusterEndpoint',
        'DeleteDBInstanceAutomatedBackup',
        'DeleteDBProxy',
        'DeleteGlobalCluster',
        'DeregisterDBProxyTargets',
        'DescribeDBClusterBacktracks',
        'DescribeDBClusterEndpoints',
        'DescribeDBInstanceAutomatedBackups',
        'DescribeDBProxies',
        'DescribeDBProxyTargetGroups',
        'DescribeDBProxyTargets',
        'DescribeExportTasks',
        'DescribeGlobalClusters',
        'DescribeSourceRegions',
        'DescribeValidDBInstanceModifications',
        'ModifyCurrentDBClusterCapacity',
        'ModifyDBClusterEndpoint',
        'ModifyDBProxy',
        'ModifyDBProxyTargetGroup',
        'ModifyDBSnapshot',
        'ModifyGlobalCluster',
        'PromoteReadReplicaDBCluster',
        'RegisterDBProxyTargets',
        'RemoveFromGlobalCluster',
        'RemoveRoleFromDBCluster',
        'RemoveRoleFromDBInstance',
        'RestoreDBClusterFromS3',
        'RestoreDBInstanceFromS3',
        'StartActivityStream',
        'StartDBCluster',
        'StartExportTask',
        'StopActivityStream',
        'StopDBCluster',
    ],
    'redshift': [
        'AcceptReservedNodeExchange',
        'BatchDeleteClusterSnapshots',
        'BatchModifyClusterSnapshots',
        'CancelQuery',
        'CancelResize',
        'CreateSavedQuery',
        'CreateScheduledAction',
        'CreateSnapshotSchedule',
        'DeleteSavedQueries',
        'DeleteScheduledAction',
        'DeleteSnapshotSchedule',
        'DescribeAccountAttributes',
        'DescribeClusterDbRevisions',
        'DescribeClusterTracks',
        'DescribeNodeConfigurationOptions',
        'DescribeQuery',
        'DescribeSavedQueries',
        'DescribeScheduledActions',
        'DescribeSnapshotSchedules',
        'DescribeStorage',
        'DescribeTable',
        'ExecuteQuery',
        'FetchResults',
        'GetReservedNodeExchangeOfferings',
        'ListDatabases',
        'ListSavedQueries',
        'ListSchemas',
        'ListTables',
        'ModifyClusterDbRevision',
        'ModifyClusterMaintenance',
        'ModifyClusterSnapshot',
        'ModifyClusterSnapshotSchedule',
        'ModifySavedQuery',
        'ModifyScheduledAction',
        'ModifySnapshotSchedule',
        'ResizeCluster',
        'ViewQueriesFromConsole',
    ],
    'rekognition': [
        'CreateProject',
        'CreateProjectVersion',
        'DescribeCollection',
        'DescribeProjects',
        'DescribeProjectVersions',
        'DetectCustomLabels',
        'GetTextDetection',
        'StartProjectVersion',
        'StartTextDetection',
        'StopProjectVersion',
    ],
    'route53': [
        'CreateQueryLoggingConfig',
        'DeleteQueryLoggingConfig',
        'GetAccountLimit',
        'GetHostedZoneLimit',
        'GetQueryLoggingConfig',
        'GetReusableDelegationSetLimit',
        'ListQueryLoggingConfigs',
    ],
    's3': [
        'BypassGovernanceRetention',
        'CreateAccessPoint',
        'CreateJob',
        'DeleteAccessPoint',
        'DeleteAccessPointPolicy',
        'DescribeJob',
        'GetAccessPoint',
        'GetAccessPointPolicy',
        'GetAccessPointPolicyStatus',
        'GetAccountPublicAccessBlock',
        'GetBucketObjectLockConfiguration',
        'GetBucketPolicyStatus',
        'GetBucketPublicAccessBlock',
        'GetEncryptionConfiguration',
        'GetObjectLegalHold',
        'GetObjectRetention',
        'ListAccessPoints',
        'ListJobs',
        'ObjectOwnerOverrideToBucketOwner',
        'PutAccessPointPolicy',
        'PutAccountPublicAccessBlock',
        'PutBucketObjectLockConfiguration',
        'PutBucketPublicAccessBlock',
        'PutEncryptionConfiguration',
        'PutObjectLegalHold',
        'PutObjectRetention',
        'ReplicateTags',
        'UpdateJobPriority',
        'UpdateJobStatus',
    ],
    'sagemaker': [
        'CreateAlgorithm',
        'CreateCodeRepository',
        'CreateCompilationJob',
        'CreateHyperParameterTuningJob',
        'CreateLabelingJob',
        'CreateModelPackage',
        'CreateNotebookInstanceLifecycleConfig',
        'CreateTransformJob',
        'CreateWorkteam',
        'DeleteAlgorithm',
        'DeleteCodeRepository',
        'DeleteModelPackage',
        'DeleteNotebookInstanceLifecycleConfig',
        'DeleteWorkteam',
        'DescribeAlgorithm',
        'DescribeCodeRepository',
        'DescribeCompilationJob',
        'DescribeHyperParameterTuningJob',
        'DescribeLabelingJob',
        'DescribeModelPackage',
        'DescribeNotebookInstanceLifecycleConfig',
        'DescribeSubscribedWorkteam',
        'DescribeTransformJob',
        'DescribeWorkteam',
        'GetSearchSuggestions',
        'ListAlgorithms',
        'ListCodeRepositories',
        'ListCompilationJobs',
        'ListHyperParameterTuningJobs',
        'ListLabelingJobs',
        'ListLabelingJobsForWorkteam',
        'ListModelPackages',
        'ListNotebookInstanceLifecycleConfigs',
        'ListSubscribedWorkteams',
        'ListTrainingJobsForHyperParameterTuningJob',
        'ListTransformJobs',
        'ListWorkteams',
        'RenderUiTemplate',
        'Search',
        'StopCompilationJob',
        'StopHyperParameterTuningJob',
        'StopLabelingJob',
        'StopTransformJob',
        'UpdateCodeRepository',
        'UpdateNotebookInstanceLifecycleConfig',
        'UpdateWorkteam',
    ],
    'serverlessrepo': [
        'CreateCloudFormationTemplate',
        'GetCloudFormationTemplate',
        'ListApplicationDependencies',
    ],
    'servicecatalog': [
        'AssociateBudgetWithResource',
        'AssociateServiceActionWithProvisioningArtifact',
        'AssociateTagOptionWithResource',
        'BatchAssociateServiceActionWithProvisioningArtifact',
        'BatchDisassociateServiceActionFromProvisioningArtifact',
        'CopyProduct',
        'CreateProvisionedProductPlan',
        'CreateServiceAction',
        'CreateTagOption',
        'DeleteProvisionedProductPlan',
        'DeleteServiceAction',
        'DeleteTagOption',
        'DescribeCopyProductStatus',
        'DescribePortfolioShareStatus',
        'DescribeProvisionedProduct',
        'DescribeProvisionedProductPlan',
        'DescribeServiceAction',
        'DescribeServiceActionExecutionParameters',
        'DescribeTagOption',
        'DisableAWSOrganizationsAccess',
        'DisassociateBudgetFromResource',
        'DisassociateServiceActionFromProvisioningArtifact',
        'DisassociateTagOptionFromResource',
        'EnableAWSOrganizationsAccess',
        'ExecuteProvisionedProductPlan',
        'ExecuteProvisionedProductServiceAction',
        'GetAWSOrganizationsAccessStatus',
        'ListBudgetsForResource',
        'ListOrganizationPortfolioAccess',
        'ListProvisionedProductPlans',
        'ListProvisioningArtifactsForServiceAction',
        'ListResourcesForTagOption',
        'ListServiceActions',
        'ListServiceActionsForProvisioningArtifact',
        'ListStackInstancesForProvisionedProduct',
        'ListTagOptions',
        'SearchProvisionedProducts',
        'UpdateProvisionedProductProperties',
        'UpdateServiceAction',
        'UpdateTagOption',
    ],
    'servicediscovery': [
        'CreateHttpNamespace',
        'DiscoverInstances',
        'UpdateInstanceCustomHealthStatus',
    ],
    'shield': [
        'AssociateDRTLogBucket',
        'AssociateDRTRole',
        'DescribeDRTAccess',
        'DescribeEmergencyContactSettings',
        'DisassociateDRTLogBucket',
        'DisassociateDRTRole',
        'GetSubscriptionState',
        'UpdateEmergencyContactSettings',
        'UpdateSubscription',
    ],
    'signer': [
        'CancelSigningProfile',
        'GetSigningPlatform',
        'GetSigningProfile',
        'ListSigningPlatforms',
        'ListSigningProfiles',
        'ListTagsForResource',
        'PutSigningProfile',
        'TagResource',
        'UntagResource',
    ],
    'sns': [
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
    ],
    'ssm': [
        'CancelMaintenanceWindowExecution',
        'CreateOpsItem',
        'DeleteInventory',
        'DescribeAssociationExecutions',
        'DescribeAssociationExecutionTargets',
        'DescribeInventoryDeletions',
        'DescribeMaintenanceWindowSchedule',
        'DescribeMaintenanceWindowsForTarget',
        'DescribeOpsItems',
        'DescribePatchProperties',
        'DescribeSessions',
        'GetConnectionStatus',
        'GetOpsItem',
        'GetOpsSummary',
        'GetServiceSetting',
        'LabelParameterVersion',
        'ListComplianceItems',
        'ListComplianceSummaries',
        'ListResourceComplianceSummaries',
        'ResetServiceSetting',
        'ResumeSession',
        'StartSession',
        'TerminateSession',
        'UpdateInstanceInformation',
        'UpdateOpsItem',
        'UpdateResourceDataSync',
        'UpdateServiceSetting',
    ],
    'sso': [
        'AddMemberToGroup',
        'CreateAlias',
        'CreateGroup',
        'CreateManagedApplicationInstance',
        'CreateUser',
        'DeleteGroup',
        'DeleteManagedApplicationInstance',
        'DeleteUser',
        'DescribeGroups',
        'DescribeUsers',
        'DisableUser',
        'EnableUser',
        'GetManagedApplicationInstance',
        'GetMfaDeviceManagementForDirectory',
        'GetPermissionsPolicy',
        'GetSharedSsoConfiguration',
        'GetSsoConfiguration',
        'GetSSOConfiguration',
        'GetUserPoolInfo',
        'ListApplications',
        'ListGroupsForUser',
        'ListMembersInGroup',
        'PutMfaDeviceManagementForDirectory',
        'RemoveMemberFromGroup',
        'SearchGroups',
        'SearchUsers',
        'SetTemporaryPassword',
        'UpdateGroup',
        'UpdateManagedApplicationInstanceStatus',
        'UpdatePermissionSet',
        'UpdateSSOConfiguration',
        'UpdateUser',
    ],
    'sso_directory': [
        'CompleteVirtualMfaDeviceRegistration',
        'CreateBearerToken',
        'CreateExternalIdPConfigurationForDirectory',
        'CreateProvisioningTenant',
        'DeleteBearerToken',
        'DeleteExternalIdPConfigurationForDirectory',
        'DeleteMfaDeviceForUser',
        'DeleteProvisioningTenant',
        'DisableExternalIdPConfigurationForDirectory',
        'EnableExternalIdPConfigurationForDirectory',
        'GetAWSSPConfigurationForDirectory',
        'ListBearerTokens',
        'ListExternalIdPConfigurationsForDirectory',
        'ListMfaDevicesForUser',
        'ListProvisioningTenants',
        'SearchGroups',
        'SearchUsers',
        'StartVirtualMfaDeviceRegistration',
        'UpdateExternalIdPConfigurationForDirectory',
    ],
    'states': [
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
    ],
    'storagegateway': [
        'AttachVolume',
        'CreateSMBFileShare',
        'DescribeSMBFileShares',
        'DescribeSMBSettings',
        'DetachVolume',
        'JoinDomain',
        'NotifyWhenUploaded',
        'SetSMBGuestPassword',
        'UpdateSMBFileShare',
    ],
    'sts': [
        'GetAccessKeyInfo',
        'GetServiceBearerToken',
        'TagSession',
    ],
    'support': [
        'DescribeCaseAttributes',
        'DescribeIssueTypes',
        'DescribeSupportLevel',
        'InitiateCallForCase',
        'InitiateChatForCase',
        'PutCaseAttributes',
        'RateCaseCommunication',
        'SearchForCases',
    ],
    'swf': [
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
    ],
    'tag': [
        'DescribeReportCreation',
        'GetComplianceSummary',
        'StartReportCreation',
    ],
    'transcribe': [
        'CreateVocabulary',
        'CreateVocabularyFilter',
        'DeleteTranscriptionJob',
        'DeleteVocabulary',
        'DeleteVocabularyFilter',
        'GetVocabulary',
        'GetVocabularyFilter',
        'ListVocabularies',
        'ListVocabularyFilters',
        'StartStreamTranscription',
        'UpdateVocabulary',
        'UpdateVocabularyFilter',
    ],
    'translate': [
        'DeleteTerminology',
        'DescribeTextTranslationJob',
        'GetTerminology',
        'ImportTerminology',
        'ListTerminologies',
        'ListTextTranslationJobs',
        'StartTextTranslationJob',
        'StopTextTranslationJob',
    ],
    'trustedadvisor': [
        'DescribeAccount',
        'DescribeAccountAccess',
        'DescribeChecks',
        'SetAccountAccess',
    ],
    'waf': [
        'CreateRuleGroup',
        'DeleteLoggingConfiguration',
        'DeletePermissionPolicy',
        'DeleteRuleGroup',
        'GetLoggingConfiguration',
        'GetPermissionPolicy',
        'GetRuleGroup',
        'ListActivatedRulesInRuleGroup',
        'ListLoggingConfigurations',
        'ListRuleGroups',
        'ListSubscribedRuleGroups',
        'ListTagsForResource',
        'PutLoggingConfiguration',
        'PutPermissionPolicy',
        'TagResource',
        'UntagResource',
        'UpdateRuleGroup',
    ],
    'waf_regional': [
        'CreateRuleGroup',
        'DeleteLoggingConfiguration',
        'DeletePermissionPolicy',
        'DeleteRuleGroup',
        'GetLoggingConfiguration',
        'GetPermissionPolicy',
        'GetRuleGroup',
        'ListActivatedRulesInRuleGroup',
        'ListLoggingConfigurations',
        'ListRuleGroups',
        'ListSubscribedRuleGroups',
        'ListTagsForResource',
        'PutLoggingConfiguration',
        'PutPermissionPolicy',
        'TagResource',
        'UntagResource',
        'UpdateRuleGroup',
    ],
    'workdocs': [
        'CreateComment',
        'CreateCustomMetadata',
        'CreateLabels',
        'DeleteComment',
        'DeleteCustomMetadata',
        'DeleteLabels',
        'DescribeActivities',
        'DescribeComments',
        'DescribeGroups',
        'DescribeRootFolders',
        'DownloadDocumentVersion',
        'GetCurrentUser',
        'GetResources',
    ],
    'workmail': [
        'AssociateDelegateToResource',
        'AssociateMemberToGroup',
        'CreateAlias',
        'CreateInboundMailFlowRule',
        'CreateOutboundMailFlowRule',
        'CreateSmtpGateway',
        'CreateUser',
        'DeleteAlias',
        'DeleteGroup',
        'DeleteInboundMailFlowRule',
        'DeleteMailboxPermissions',
        'DeleteOutboundMailFlowRule',
        'DeleteResource',
        'DeleteSmtpGateway',
        'DeleteUser',
        'DeregisterFromWorkMail',
        'DescribeGroup',
        'DescribeInboundMailFlowRule',
        'DescribeOrganization',
        'DescribeOutboundMailFlowRule',
        'DescribeResource',
        'DescribeSmtpGateway',
        'DescribeUser',
        'DisassociateDelegateFromResource',
        'DisassociateMemberFromGroup',
        'GetJournalingRules',
        'GetMailboxDetails',
        'ListAliases',
        'ListGroupMembers',
        'ListGroups',
        'ListInboundMailFlowRules',
        'ListMailboxPermissions',
        'ListOrganizations',
        'ListOutboundMailFlowRules',
        'ListResourceDelegates',
        'ListResources',
        'ListSmtpGateways',
        'ListUsers',
        'PutMailboxPermissions',
        'RegisterToWorkMail',
        'ResetPassword',
        'SetJournalingRules',
        'TestInboundMailFlowRules',
        'TestOutboundMailFlowRules',
        'UpdateInboundMailFlowRule',
        'UpdateMailboxQuota',
        'UpdateOutboundMailFlowRule',
        'UpdatePrimaryEmailAddress',
        'UpdateResource',
        'UpdateSmtpGateway',
    ],
    'workspaces': [
        'AssociateIpGroups',
        'AuthorizeIpRules',
        'CreateIpGroup',
        'DeleteIpGroup',
        'DeleteWorkspaceImage',
        'DescribeAccount',
        'DescribeAccountModifications',
        'DescribeClientProperties',
        'DescribeIpGroups',
        'DescribeWorkspaceImages',
        'DisassociateIpGroups',
        'ImportWorkspaceImage',
        'ListAvailableManagementCidrRanges',
        'ModifyAccount',
        'ModifyClientProperties',
        'ModifyWorkspaceState',
        'RevokeIpRules',
        'UpdateRulesOfIpGroup',
    ],
    'xray': [
        'CreateGroup',
        'CreateSamplingRule',
        'DeleteGroup',
        'DeleteSamplingRule',
        'GetEncryptionConfig',
        'GetGroup',
        'GetGroups',
        'GetSamplingRules',
        'GetSamplingStatisticSummaries',
        'GetSamplingTargets',
        'GetTimeSeriesServiceStatistics',
        'PutEncryptionConfig',
        'UpdateGroup',
        'UpdateSamplingRule',
    ]
}


# Some actions appear to be deleted but still in the docs. This grouping
# will keep them available as it gets sorted out.
# Actions should be added alphabetically under their appropriate awacs prefix.
# Note: If the prefix contains a '-' (dash) character, replace it with
# an '_' (underscore).
deleted_actions = {
    'cloudsearch': [
        'DefineIndexFields',
    ],
    'cognito_idp': [
        'ListUserPools', 'ListUsers',
    ],
    'dax': [
        'DefineAttributeList', 'DefineAttributeListId', 'DefineKeySchema',
    ],
    'ec2': [
        'ModifySpotFleetRequest',
    ],
    'elasticbeanstalk': [
        'AddTags', 'ListTagsForResource', 'RemoveTags',
    ],
    'glue': [
        'GetDataCatalogEncryptionSettings', 'PutDataCatalogEncryptionSettings',
        'CreateSecurityConfiguration', 'GetSecurityConfiguration',
        'GetSecurityConfigurations', 'DeleteSecurityConfiguration',
    ],
    'kinesis': [
        'StartStreamEncryption', 'StopStreamEncryption',
    ],
    'kinesisanalytics': [
        'GetApplicationState',
        'ListTagsForResource',
        'TagResource',
        'UntagResource',
    ],
    'kms': [
        'ConnectCustomKeyStore',
        'CreateCustomKeyStore',
        'DeleteCustomKeyStore',
        'DescribeCustomKeyStores',
        'DisconnectCustomKeyStore',
        'ReEncrypt',
        'UpdateCustomKeyStore',
    ],
    'mechanicalturk': [
        'AcceptQualificationRequest', 'AssociateQualificationWithWorker',
        'CreateHITType', 'CreateHITWithHITType', 'CreateWorkerBlock',
        'DeleteHIT', 'DeleteQualificationType', 'DeleteWorkerBlock',
        'DisassociateQualificationFromWorker', 'ListAssignmentsForHIT',
        'ListBonusPayments', 'ListHITs', 'ListHITsForQualificationType',
        'ListQualificationRequests', 'ListQualificationTypes',
        'ListReviewPolicyResultsForHIT', 'ListReviewableHITs',
        'ListWorkerBlocks', 'ListWorkersWithQualificationType',
        'SendBonus', 'UpdateExpirationForHIT', 'UpdateHITReviewStatus',
        'UpdateHITTypeOfHIT', 'UpdateNotificationSettings',
    ],
    'mobilehub': [
        'ValidateProject',
    ],
    'mobiletargeting': [
        'DeleteAdmChannel', 'DeleteAdmChannel', 'DeleteApnsSandboxChannel',
        'GetAdmChannel', 'GetApnsSandboxChannel', 'UpdateAdmChannel',
        'UpdateApnsSandboxChannel',
    ],
    'route53': [
        'CreateVPCAssociationAuthorization',
        'DeleteVPCAssociationAuthorization',
        'ListVPCAssociationAuthorizations',
    ],
    'route53domain': [
        'DeleteDomain',
    ],
    'tag': [
        'AddResourceTags', 'RemoveResourceTags',
    ],
}

# patch in the extra_services if they are not present in policies.js
for service_name in extra_services:
    if not d['serviceMap'].get(service_name):
        d['serviceMap'][service_name] = extra_services[service_name]


filename_seen = {}
for serviceName, serviceValue in d['serviceMap'].items():
    prefix = serviceValue['StringPrefix']
    service = prefix
    # Handle prefix such as "directconnect:"
    if prefix[-1] == ':':
        service = prefix[:-1]
    if service == 'lambda':
        service = 'awslambda'
    service = service.replace("-", "_")
    filename = ''.join([basedir, "/", service, ".py"])
    with open(filename, "a") as fp:
        if filename not in filename_seen:
            filename_seen[filename] = True
            if prefix in legacy_arns:
                fp.write("import warnings\n")
            fp.write(header)
            fp.write("\n")
            fp.write("service_name = '%s'\n" % (serviceName,))
            fp.write("prefix = '%s'\n" % (prefix,))
            fp.write("\n\n")
            if service == "s3":
                fp.write(extra_classes_s3)
            else:
                fp.write(extra_classes)
            fp.write("\n\n")
            if prefix in legacy_arns:
                fp.write(arn % {
                    'lower': prefix,
                    'upper': prefix.upper(),
                })
                fp.write("\n\n")

        # Make sure there are no actions in both the extra_actions
        # and deleted_actions.
        if service in extra_actions and service in deleted_actions:
            intersection = set(extra_actions[service]) & \
                           set(deleted_actions[service])
            if intersection:
                raise RuntimeError('Actions found that appear in both '
                                   '`extra_actions` and `deleted_actions` '
                                   'for the aws service `{}`: {}'.format(
                                        service, intersection))

        # Add actions AWS hasn't added yet
        if service in extra_actions:
            serviceValue['Actions'].extend(extra_actions[service])

        # Add actions AWS may have inadvertantly deleted
        if service in deleted_actions:
            serviceValue['Actions'].extend(deleted_actions[service])

        # Make the set sorted and unique
        serviceValue['Actions'] = sorted(set(serviceValue['Actions']))

        for action in serviceValue['Actions']:
            action = action.strip()
            # Handle action such as "ReEncrypt*"
            if action[-1] == '*':
                action = action[:-1]
            # Wrap lines for pep8
            if len(action) > 30:
                format = "%s = \\\n    Action('%s')\n"
            else:
                format = "%s = Action('%s')\n"
            fp.write(format % (action, action))
